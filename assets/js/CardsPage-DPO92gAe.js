import{r as e,j as a,ay as r,B as s,C as t,A as n,T as l,k as d,s as i,P as c,aM as x,aA as o,p as h,q as u,I as j,b1 as m,t as p,v as y,a3 as _,aS as v,D as f,b as g,d as C,at as b,au as S,av as k,aw as w,h as A,i as W}from"./mui-DNFLHsKH.js";import{a as F}from"./index-BhCXqEsx.js";import"./vendor-HnKmhvXM.js";import"./utils-n36L7CQ6.js";import"./router-D0-id3Zg.js";const I=()=>{const[I,D]=e.useState([]),[M,E]=e.useState(!0),[N,Y]=e.useState(null),[z,B]=e.useState(!1),[T,U]=e.useState(!1),[L,O]=e.useState(null),[V,$]=e.useState({card_type:"",card_number:"",card_holder_name:"",expiry_month:"",expiry_year:"",is_default:!1});e.useEffect(()=>{q()},[]);const q=async()=>{try{E(!0),Y(null);const e=await F.get("/customer/cards");e.data.success?D(e.data.cards):Y("Failed to fetch cards")}catch(e){Y(e.response?.data?.error||"Failed to fetch cards")}finally{E(!1)}},H=e=>{O(e),$({card_type:e.card_type||"",card_number:"",card_holder_name:e.card_holder_name||"",expiry_month:e.expiry_month||"",expiry_year:e.expiry_year||"",is_default:e.is_default||!1}),U(!0)},P=()=>{$({card_type:"",card_number:"",card_holder_name:"",expiry_month:"",expiry_year:"",is_default:!1})},R=e=>{switch(e?.toLowerCase()){case"visa":return a.jsx(x,{sx:{color:"#1A1F71"}});case"mastercard":return a.jsx(x,{sx:{color:"#EB001B"}});default:return a.jsx(x,{})}},G=()=>{const e=(new Date).getFullYear(),a=[];for(let r=0;r<10;r++)a.push(e+r);return a},J=()=>Array.from({length:12},(e,a)=>a+1);return M?a.jsx(r,{maxWidth:"lg",sx:{py:4},children:a.jsx(s,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:a.jsx(t,{})})}):N?a.jsx(r,{maxWidth:"lg",sx:{py:4},children:a.jsx(n,{severity:"error",sx:{mb:3},children:N})}):a.jsxs(r,{maxWidth:"lg",sx:{py:4},children:[a.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[a.jsxs(s,{children:[a.jsx(l,{variant:"h4",component:"h1",gutterBottom:!0,children:"Saved Cards"}),a.jsx(l,{variant:"body1",color:"text.secondary",children:"Manage your payment methods for faster checkout"})]}),a.jsx(d,{variant:"contained",startIcon:a.jsx(i,{}),onClick:()=>B(!0),children:"Add Card"})]}),0===I.length?a.jsxs(c,{sx:{p:4,textAlign:"center"},children:[a.jsx(x,{sx:{fontSize:64,color:"text.secondary",mb:2}}),a.jsx(l,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Saved Cards"}),a.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Add your payment cards for faster and more convenient checkout."}),a.jsx(d,{variant:"contained",startIcon:a.jsx(i,{}),onClick:()=>B(!0),children:"Add Your First Card"})]}):a.jsx(o,{container:!0,spacing:3,children:I.map(e=>{return a.jsx(o,{item:!0,xs:12,md:6,lg:4,children:a.jsx(h,{sx:{position:"relative"},children:a.jsxs(u,{children:[a.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[a.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[R(e.card_type),a.jsx(l,{variant:"h6",children:e.card_type?.toUpperCase()||"CARD"})]}),a.jsxs(s,{sx:{display:"flex",gap:1},children:[a.jsx(j,{size:"small",onClick:()=>H(e),children:a.jsx(m,{})}),a.jsx(j,{size:"small",color:"error",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this card?"))try{(await F.delete(`/customer/cards/${e}`)).data.success?q():Y("Failed to delete card")}catch(a){Y(a.response?.data?.error||"Failed to delete card")}})(e.card_id),children:a.jsx(p,{})})]})]}),a.jsx(l,{variant:"h6",sx:{fontFamily:"monospace",mb:1},children:e.card_number_masked}),a.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:1},children:e.card_holder_name}),a.jsxs(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Expires: ",e.expiry_month,"/",e.expiry_year]}),a.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.is_default?a.jsx(y,{icon:a.jsx(_,{}),label:"Default",color:"primary",size:"small"}):a.jsx(y,{icon:a.jsx(v,{}),label:"Set as Default",variant:"outlined",size:"small",onClick:()=>H({...e,is_default:!0}),sx:{cursor:"pointer"}}),a.jsxs(l,{variant:"caption",color:"text.secondary",children:["Added ",(r=e.created_at,r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A")]})]})]})})},e.card_id);var r})}),a.jsxs(f,{open:z,onClose:()=>B(!1),maxWidth:"sm",fullWidth:!0,children:[a.jsx(g,{children:"Add New Card"}),a.jsx(C,{children:a.jsxs(o,{container:!0,spacing:2,sx:{mt:1},children:[a.jsx(o,{item:!0,xs:12,children:a.jsxs(b,{fullWidth:!0,children:[a.jsx(S,{children:"Card Type"}),a.jsxs(k,{value:V.card_type,onChange:e=>$({...V,card_type:e.target.value}),label:"Card Type",children:[a.jsx(w,{value:"visa",children:"Visa"}),a.jsx(w,{value:"mastercard",children:"Mastercard"}),a.jsx(w,{value:"amex",children:"American Express"}),a.jsx(w,{value:"discover",children:"Discover"}),a.jsx(w,{value:"other",children:"Other"})]})]})}),a.jsx(o,{item:!0,xs:12,children:a.jsx(A,{fullWidth:!0,label:"Card Number",value:V.card_number,onChange:e=>$({...V,card_number:e.target.value}),placeholder:"1234 5678 9012 3456"})}),a.jsx(o,{item:!0,xs:12,children:a.jsx(A,{fullWidth:!0,label:"Cardholder Name",value:V.card_holder_name,onChange:e=>$({...V,card_holder_name:e.target.value})})}),a.jsx(o,{item:!0,xs:6,children:a.jsxs(b,{fullWidth:!0,children:[a.jsx(S,{children:"Month"}),a.jsx(k,{value:V.expiry_month,onChange:e=>$({...V,expiry_month:e.target.value}),label:"Month",children:J().map(e=>a.jsx(w,{value:e,children:e.toString().padStart(2,"0")},e))})]})}),a.jsx(o,{item:!0,xs:6,children:a.jsxs(b,{fullWidth:!0,children:[a.jsx(S,{children:"Year"}),a.jsx(k,{value:V.expiry_year,onChange:e=>$({...V,expiry_year:e.target.value}),label:"Year",children:G().map(e=>a.jsx(w,{value:e,children:e},e))})]})}),a.jsx(o,{item:!0,xs:12,children:a.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx("input",{type:"checkbox",checked:V.is_default,onChange:e=>$({...V,is_default:e.target.checked})}),a.jsx(l,{variant:"body2",children:"Set as default payment method"})]})})]})}),a.jsxs(W,{children:[a.jsx(d,{onClick:()=>B(!1),children:"Cancel"}),a.jsx(d,{onClick:async()=>{try{(await F.post("/customer/cards",V)).data.success?(B(!1),P(),q()):Y("Failed to add card")}catch(e){Y(e.response?.data?.error||"Failed to add card")}},variant:"contained",children:"Add Card"})]})]}),a.jsxs(f,{open:T,onClose:()=>U(!1),maxWidth:"sm",fullWidth:!0,children:[a.jsx(g,{children:"Edit Card"}),a.jsx(C,{children:a.jsxs(o,{container:!0,spacing:2,sx:{mt:1},children:[a.jsx(o,{item:!0,xs:12,children:a.jsxs(b,{fullWidth:!0,children:[a.jsx(S,{children:"Card Type"}),a.jsxs(k,{value:V.card_type,onChange:e=>$({...V,card_type:e.target.value}),label:"Card Type",children:[a.jsx(w,{value:"visa",children:"Visa"}),a.jsx(w,{value:"mastercard",children:"Mastercard"}),a.jsx(w,{value:"amex",children:"American Express"}),a.jsx(w,{value:"discover",children:"Discover"}),a.jsx(w,{value:"other",children:"Other"})]})]})}),a.jsx(o,{item:!0,xs:12,children:a.jsx(A,{fullWidth:!0,label:"Cardholder Name",value:V.card_holder_name,onChange:e=>$({...V,card_holder_name:e.target.value})})}),a.jsx(o,{item:!0,xs:6,children:a.jsxs(b,{fullWidth:!0,children:[a.jsx(S,{children:"Month"}),a.jsx(k,{value:V.expiry_month,onChange:e=>$({...V,expiry_month:e.target.value}),label:"Month",children:J().map(e=>a.jsx(w,{value:e,children:e.toString().padStart(2,"0")},e))})]})}),a.jsx(o,{item:!0,xs:6,children:a.jsxs(b,{fullWidth:!0,children:[a.jsx(S,{children:"Year"}),a.jsx(k,{value:V.expiry_year,onChange:e=>$({...V,expiry_year:e.target.value}),label:"Year",children:G().map(e=>a.jsx(w,{value:e,children:e},e))})]})}),a.jsx(o,{item:!0,xs:12,children:a.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx("input",{type:"checkbox",checked:V.is_default,onChange:e=>$({...V,is_default:e.target.checked})}),a.jsx(l,{variant:"body2",children:"Set as default payment method"})]})})]})}),a.jsxs(W,{children:[a.jsx(d,{onClick:()=>U(!1),children:"Cancel"}),a.jsx(d,{onClick:async()=>{try{(await F.put(`/customer/cards/${L.card_id}`,V)).data.success?(U(!1),O(null),P(),q()):Y("Failed to update card")}catch(e){Y(e.response?.data?.error||"Failed to update card")}},variant:"contained",children:"Update Card"})]})]})]})};export{I as default};
