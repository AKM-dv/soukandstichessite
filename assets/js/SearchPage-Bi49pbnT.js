import{a as e,r,j as t,B as s,e as o,aw as n,I as a,ay as i,T as l,aA as c,a8 as d,A as x,aE as p,aB as u,aC as h,aD as g,Q as f}from"./mui-B4o7H9uu.js";import{u as m,a as b,b as j,c as y}from"./index-DEWzifVT.js";import{C,P as v}from"./CarouselItem-C5QKeJgv.js";import{d as S}from"./router-BDKlY_bR.js";import"./vendor-HnKmhvXM.js";import"./utils-yHh8wlql.js";const k=()=>{const[k]=S(),w=m(),I=e("(max-width:768px)"),R=e("(max-width:1024px)"),{addToCart:W,isLoggedIn:z,login:B}=b(),[M,A]=r.useState([]),[F,E]=r.useState([]),[L,O]=r.useState(!0),[P,D]=r.useState(!1),[H,T]=r.useState({open:!1,message:"",severity:"success"}),[$,_]=r.useState(null),[N,q]=r.useState(!1),[Q,U]=r.useState(""),[V,Z]=r.useState([0,1e5]),[G,J]=r.useState("newest");r.useEffect(()=>{const e=k.get("q");e?(A([]),E([]),U(e),K(e)):(A([]),E([]),U(""),O(!1))},[k]),r.useEffect(()=>{X()},[M,V,G]);const K=async e=>{try{O(!0);const r=await j.get(`/search?q=${encodeURIComponent(e)}`);if(r.data?.success){const e=r.data.products||[],t=await Promise.all(e.map(async e=>{try{const r=await j.get(`/product/${e.product_id}`);if(r.data?.success&&r.data?.product){const t=(r.data.product.images||[]).map(e=>{if(e&&e.includes("/uploads/")){return`https://soukandstiches.mycartly.in${e.substring(e.indexOf("/uploads/"))}`}return e});return{...e,images:t}}}catch(r){}return e}));A(t)}else A([])}catch(r){A([])}finally{O(!1)}},X=()=>{let e=[...M];e=e.filter(e=>{const r=parseFloat(e.price)||0;return r>=V[0]&&r<=V[1]}),e.sort((e,r)=>{switch(G){case"price-low":return(parseFloat(e.price)||0)-(parseFloat(r.price)||0);case"price-high":return(parseFloat(r.price)||0)-(parseFloat(e.price)||0);case"name":return e.name.localeCompare(r.name);default:return new Date(r.created_at||0)-new Date(e.created_at||0)}}),E(e)},Y=(e,r)=>{Z(r)},ee=e=>{J(e.target.value)},re=()=>t.jsxs(s,{sx:{p:2,height:"fit-content",bgcolor:"#fafafa",borderRight:"1px solid #e0e0e0"},children:[t.jsxs(l,{variant:"body2",sx:{color:"#666",mb:2,fontSize:"12px"},children:['Home > Search > "',Q,'"']}),t.jsx(s,{sx:{mb:3},children:t.jsx("button",{onClick:()=>w("/",{},{reloadOn:["/"],forceReload:!0}),style:{width:"100%",textAlign:"left",color:"#333",fontSize:"14px",fontWeight:500,padding:"8px 12px",border:"none",background:"transparent",cursor:"pointer",borderRadius:"4px",transition:"background-color 0.2s ease"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(0,0,0,0.04)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"Home"})}),t.jsxs(s,{sx:{mb:3},children:[t.jsx(l,{variant:"h6",sx:{mb:1.5,fontWeight:600,color:"#8B4513",fontSize:"16px"},children:"Price Range"}),t.jsxs(s,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[t.jsx("button",{onClick:()=>Z([0,7500]),style:{width:"100%",textAlign:"left",color:"#333",fontSize:"14px",fontWeight:400,padding:"8px 12px",border:"none",background:"transparent",cursor:"pointer",borderRadius:"4px",transition:"background-color 0.2s ease"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(0,0,0,0.04)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"Rs. 0 - 7,500"}),t.jsx("button",{onClick:()=>Z([7501,15e3]),style:{width:"100%",textAlign:"left",color:"#333",fontSize:"14px",fontWeight:400,padding:"8px 12px",border:"none",background:"transparent",cursor:"pointer",borderRadius:"4px",transition:"background-color 0.2s ease"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(0,0,0,0.04)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"Rs. 7,501 - 15,000"}),t.jsx("button",{onClick:()=>Z([15e3,1e5]),style:{width:"100%",textAlign:"left",color:"#333",fontSize:"14px",fontWeight:400,padding:"8px 12px",border:"none",background:"transparent",cursor:"pointer",borderRadius:"4px",transition:"background-color 0.2s ease"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(0,0,0,0.04)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"Rs. 15,000+"})]})]}),t.jsxs(s,{children:[t.jsx(l,{variant:"h6",sx:{mb:1.5,fontWeight:600,color:"#8B4513",fontSize:"16px"},children:"Filters"}),t.jsxs(s,{sx:{mb:2},children:[t.jsxs(l,{variant:"body2",sx:{mb:1,color:"#666"},children:["Price Range: ₹",V[0].toLocaleString()," - ₹",V[1].toLocaleString()]}),t.jsx(p,{value:V,onChange:Y,valueLabelDisplay:"auto",min:0,max:1e5,step:1e3,sx:{color:"#8B4513","& .MuiSlider-thumb":{"&:hover, &.Mui-focusVisible":{boxShadow:"0px 0px 0px 8px rgba(139, 69, 19, 0.16)"}}}})]}),t.jsx(s,{children:t.jsxs(u,{fullWidth:!0,size:"small",children:[t.jsx(h,{sx:{color:"#666"},children:"Sort By"}),t.jsxs(g,{value:G,onChange:ee,label:"Sort By",sx:{borderRadius:1,"& .MuiOutlinedInput-notchedOutline":{borderColor:"#e0e0e0"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#8B4513"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#8B4513"}},children:[t.jsx(f,{value:"newest",children:"Newest First"}),t.jsx(f,{value:"price-low",children:"Price: Low to High"}),t.jsx(f,{value:"price-high",children:"Price: High to Low"}),t.jsx(f,{value:"name",children:"Name: A to Z"})]})]})})]})]});return t.jsxs(s,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",py:{xs:2,md:4}},children:[t.jsxs(s,{sx:{maxWidth:1400,mx:"auto"},children:[t.jsxs(s,{sx:{mb:6,p:0,position:"relative",overflow:"hidden",minHeight:"300px","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:"url('https://picsum.photos/1200/400?random=search')",backgroundSize:"cover",backgroundPosition:"center",opacity:.1,zIndex:0},"& > *":{position:"relative",zIndex:1}},children:[t.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3,px:4,pt:4},children:[t.jsx(o,{startIcon:t.jsx(n,{}),onClick:()=>w("/",{},{reloadOn:["/"],forceReload:!0}),sx:{color:"#333",textTransform:"none",fontWeight:500,"&:hover":{backgroundColor:"rgba(0,0,0,0.04)"}},children:"Back to Home"}),!I&&t.jsx(s,{sx:{display:"flex",gap:2},children:t.jsx(a,{sx:{color:"#333"},children:t.jsx(i,{})})})]}),t.jsx(l,{variant:"h4",sx:{fontWeight:700,color:"#2c3e50",fontFamily:'"Inter", sans-serif',fontSize:{xs:"1.5rem",sm:"2rem",md:"2.5rem"},mb:2,textAlign:"center",px:4},children:"Search Results"}),t.jsxs(s,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:2,flexWrap:"wrap",px:4,pb:4},children:[t.jsx(l,{variant:"h6",sx:{color:"#6c757d",fontFamily:'"Inter", sans-serif',fontWeight:500},children:L?"Searching...":`${F.length} product${1!==F.length?"s":""} found for "${Q}"`}),t.jsxs(s,{sx:{display:"flex",gap:3,alignItems:"center"},children:[t.jsx(s,{sx:{background:"linear-gradient(135deg, #E91E63 0%, #C2185B 100%)",color:"white",px:2,py:1,borderRadius:2,fontSize:"0.8rem",fontWeight:600},children:"Best Prices"}),t.jsx(s,{sx:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",color:"white",px:2,py:1,borderRadius:2,fontSize:"0.8rem",fontWeight:600},children:"Free Shipping"})]})]})]}),t.jsxs(s,{sx:{display:"flex",gap:3,flexDirection:{xs:"column",lg:"row"}},children:[!R&&t.jsx(s,{sx:{width:{lg:280},flexShrink:0},children:t.jsx(s,{sx:{overflow:"hidden"},children:re()})}),t.jsx(s,{sx:{flex:1,minWidth:0},children:L?t.jsx(s,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(3, 1fr)",sm:"repeat(3, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(3, 1fr)"},gap:3,justifyContent:"center",alignItems:"start"},children:Array.from({length:8}).map((e,r)=>t.jsx(s,{sx:{width:"100%",maxWidth:"100%",justifySelf:"center"},children:t.jsx(v,{})},r))}):F.length>0?t.jsx(t.Fragment,{children:t.jsx(s,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(3, 1fr)",sm:"repeat(3, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(3, 1fr)"},gap:3,justifyContent:"center",alignItems:"start"},children:F.map(e=>t.jsx(s,{sx:{width:"100%",maxWidth:"100%",justifySelf:"start"},children:t.jsx(C,{product:e})},e.product_id))})}):t.jsxs(s,{sx:{textAlign:"center",py:8,px:4},children:[t.jsx(l,{variant:"h5",sx:{color:"#666",mb:2,fontWeight:500},children:"No products found"}),t.jsx(l,{variant:"body1",sx:{color:"#999",mb:4},children:"Try adjusting your search terms or filters"}),t.jsx(o,{variant:"contained",onClick:()=>w("/",{},{reloadOn:["/"],forceReload:!0}),sx:{background:"linear-gradient(135deg, #E91E63 0%, #C2185B 100%)","&:hover":{background:"linear-gradient(135deg, #C2185B 0%, #AD1457 100%)"}},children:"Browse All Products"})]})})]})]}),t.jsx(c,{anchor:"right",open:N,onClose:()=>q(!1),PaperProps:{sx:{width:R?320:380}},children:re()}),t.jsx(y,{open:P,onClose:()=>D(!1),onLoginSuccess:function(e){D(!1),B(e)}}),t.jsx(d,{open:H.open,autoHideDuration:3e3,onClose:()=>T({...H,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(x,{onClose:()=>T({...H,open:!1}),severity:H.severity,sx:{width:"100%"},children:H.message})})]})};export{k as default};
