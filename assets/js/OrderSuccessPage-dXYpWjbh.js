import{j as t,P as e,B as r,aO as n,T as s,Y as i,e as o,aa as a,aP as d,g as l,aG as c,t as x,r as h,f as b,A as m,aQ as g,aE as f,w as p}from"./mui-CZF-0V7l.js";import{S as u,a as j,b as v,A as y}from"./index-CM2p59Wv.js";import{c as w,u as B}from"./router-C8FM2-5r.js";import"./vendor-HnKmhvXM.js";import"./utils-BLtjaFjY.js";const W=t=>(Number(t)||0).toLocaleString("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}),S=(t,e="print")=>{const r=(t=>{const e=t?.customer_details||{},r=t?.order_summary||{},n=t?.items||[],s=t?.created_at?new Date(t.created_at).toLocaleString("en-IN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",i=n.map((t,e)=>{const r=t.quantity||1,n=Number(t.price)||0,s=n*r;return`\n      <tr>\n        <td>${e+1}</td>\n        <td>${t.name||t.product_name||"Product"}</td>\n        <td>${W(n)}</td>\n        <td>${r}</td>\n        <td>${W(s)}</td>\n      </tr>\n    `}).join("");return`\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <title>Invoice #${t?.order_id||""}</title>\n  <style>\n    :root { --primary:#4b6f44; --accent:#e94560; --border:#e9ecef; --muted:#666; }\n    * { box-sizing: border-box; font-family: 'Inter', Arial, sans-serif; }\n    body { margin: 0; padding: 24px; background: #f8f9fb; color: #1d1d1f; }\n    .invoice { max-width: 900px; margin: 0 auto; background: #fff; padding: 32px; border-radius: 12px; border: 1px solid var(--border); }\n    .header { display: flex; justify-content: space-between; align-items: flex-start; gap: 16px; }\n    .title { font-size: 28px; font-weight: 800; color: var(--primary); margin: 0; }\n    .meta { text-align: right; }\n    .label { color: var(--muted); font-size: 13px; }\n    .value { font-weight: 700; }\n    .section { margin-top: 24px; }\n    .section h3 { margin: 0 0 8px; color: var(--primary); font-size: 16px; }\n    .card { border: 1px solid var(--border); border-radius: 10px; padding: 16px; background: #fafbfc; }\n    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px,1fr)); gap: 12px; }\n    table { width: 100%; border-collapse: collapse; margin-top: 12px; }\n    th, td { padding: 10px; border-bottom: 1px solid var(--border); text-align: left; font-size: 14px; }\n    th { background: #f3f5f7; color: #34495e; }\n    tfoot td { font-weight: 700; }\n    .right { text-align: right; }\n    .totals { width: 320px; margin-left: auto; }\n    .badge { display: inline-block; padding: 6px 12px; background: #eef7f0; color: var(--primary); border-radius: 999px; font-weight: 700; font-size: 12px; }\n    .footer { margin-top: 24px; font-size: 12px; color: var(--muted); text-align: center; }\n  </style>\n</head>\n<body>\n  <div class="invoice">\n    <div class="header">\n      <div>\n        <div class="title">Invoice / Tax Invoice</div>\n        <div class="badge">Order #${t?.order_id||"N/A"}</div>\n      </div>\n      <div class="meta">\n        <div class="label">Date</div>\n        <div class="value">${s}</div>\n        <div class="label" style="margin-top:6px;">Store</div>\n        <div class="value">Souk and Stitch (ID: ${u})</div>\n      </div>\n    </div>\n\n    <div class="section grid">\n      <div class="card">\n        <h3>From</h3>\n        <div class="value">Souk and Stitch</div>\n        <div class="label">Premium Handcrafted Products</div>\n      </div>\n      <div class="card">\n        <h3>Bill To</h3>\n        <div class="value">${e.firstName||""} ${e.lastName||""}</div>\n        <div class="label">${e.address||""}</div>\n        ${e.phone?`<div class="label">Phone: ${e.phone}</div>`:""}\n        ${e.email?`<div class="label">Email: ${e.email}</div>`:""}\n      </div>\n    </div>\n\n    <div class="section">\n      <h3>Items</h3>\n      <table>\n        <thead>\n          <tr>\n            <th>#</th>\n            <th>Description</th>\n            <th class="right">Price</th>\n            <th class="right">Qty</th>\n            <th class="right">Amount</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${i||'<tr><td colspan="5">No items</td></tr>'}\n        </tbody>\n      </table>\n    </div>\n\n    <div class="section totals">\n      <table>\n        <tbody>\n          <tr><td>Subtotal</td><td class="right">${W(r.subtotal)}</td></tr>\n          <tr><td>Shipping</td><td class="right">${W(r.shipping)}</td></tr>\n          <tr><td>Tax</td><td class="right">${W(r.tax)}</td></tr>\n          <tr><td>Discount</td><td class="right">-${W(r.discount)}</td></tr>\n        </tbody>\n        <tfoot>\n          <tr><td>Total</td><td class="right">${W(r.total)}</td></tr>\n        </tfoot>\n      </table>\n    </div>\n\n    <div class="footer">\n      Thank you for shopping with us. For support, contact support@soukandstitch.in\n    </div>\n  </div>\n</body>\n</html>\n`})(t),n=window.open("","_blank","width=1024,height=1200");n&&(n.document.open(),n.document.write(r),n.document.close(),n.focus(),n.onload=()=>{"print"!==e&&"download"!==e||n.print()})},k=({order:h,onDownload:b,onPrint:m})=>{if(!h)return null;const g=h.created_at?new Date(h.created_at).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",f=h.customer_details||{},p=h.order_summary||{},u=h.items||[];return t.jsxs(e,{sx:{p:{xs:3,md:5},borderRadius:3,backgroundColor:"#FFFFFF",boxShadow:"0px 4px 20px rgba(75, 111, 68, 0.08)",border:"1px solid rgba(75, 111, 68, 0.05)"},children:[t.jsx(r,{sx:{mb:4},children:t.jsxs(r,{sx:{display:"flex",alignItems:{xs:"flex-start",md:"center"},justifyContent:"space-between",mb:3,flexWrap:"wrap",gap:2,flexDirection:{xs:"column",md:"row"}},children:[t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,width:{xs:"100%",md:"auto"}},children:[t.jsx(n,{sx:{fontSize:{xs:32,md:40},color:"#4b6f44",flexShrink:0}}),t.jsxs(r,{sx:{minWidth:0,flex:1},children:[t.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"#4b6f44",fontFamily:'"Inter", sans-serif',fontSize:{xs:"1.5rem",md:"2rem"}},children:"Invoice / Bill"}),t.jsxs(s,{variant:"body2",sx:{color:"#8B8B8B",mt:.5,wordBreak:"break-word",overflowWrap:"break-word",maxWidth:{xs:"200px",md:"100%"}},children:["Order #",h.order_id]})]})]}),t.jsxs(i,{direction:{xs:"column",md:"row"},spacing:2,sx:{width:{xs:"100%",md:"auto"}},children:[t.jsxs(o,{variant:"contained",startIcon:t.jsx(a,{}),onClick:()=>{b?b(h):S(h,"download")},sx:{background:"linear-gradient(135deg, #E94560 0%, #FF6B7A 100%)",color:"#FFFFFF",px:{xs:2,md:3},py:{xs:1.25,md:1.5},fontWeight:600,borderRadius:2,width:{xs:"100%",md:"auto"},fontSize:{xs:"0.875rem",md:"1rem"},"&:hover":{background:"linear-gradient(135deg, #C73650 0%, #E94560 100%)"}},children:["Download PDF",t.jsx("span",{"data-invoice-download":!0,hidden:!0})]}),t.jsxs(o,{variant:"outlined",startIcon:t.jsx(d,{}),onClick:()=>{m?m(h):S(h,"print")},sx:{borderColor:"#4b6f44",color:"#4b6f44",px:{xs:2,md:3},py:{xs:1.25,md:1.5},fontWeight:600,borderRadius:2,width:{xs:"100%",md:"auto"},fontSize:{xs:"0.875rem",md:"1rem"},"&:hover":{borderColor:"#16213E",bgcolor:"rgba(75, 111, 68, 0.1)"}},children:["Print",t.jsx("span",{"data-invoice-print":!0,hidden:!0})]})]})]})}),t.jsx(l,{sx:{mb:4}}),t.jsxs(c,{container:!0,spacing:4,sx:{mb:4},children:[t.jsx(c,{item:!0,xs:12,md:6,children:t.jsxs(r,{sx:{p:3,borderRadius:2,bgcolor:"rgba(75, 111, 68, 0.05)",border:"1px solid rgba(75, 111, 68, 0.1)"},children:[t.jsx(s,{variant:"h6",sx:{fontWeight:700,color:"#4b6f44",mb:2,fontFamily:'"Inter", sans-serif'},children:"From"}),t.jsx(s,{variant:"body1",sx:{fontWeight:600,color:"#4b6f44",mb:1},children:"Souk and Stitch"}),t.jsx(s,{variant:"body2",sx:{color:"#6B6B6B",lineHeight:1.7},children:"Premium Handcrafted Products"})]})}),t.jsx(c,{item:!0,xs:12,md:6,children:t.jsxs(r,{sx:{p:3,borderRadius:2,bgcolor:"rgba(75, 111, 68, 0.05)",border:"1px solid rgba(75, 111, 68, 0.1)"},children:[t.jsx(s,{variant:"h6",sx:{fontWeight:700,color:"#4b6f44",mb:2,fontFamily:'"Inter", sans-serif'},children:"Bill To"}),t.jsxs(s,{variant:"body1",sx:{fontWeight:600,color:"#4b6f44",mb:1},children:[f.firstName," ",f.lastName]}),t.jsx(s,{variant:"body2",sx:{color:"#6B6B6B",lineHeight:1.7,mb:1},children:f.address}),f.phone&&t.jsxs(s,{variant:"body2",sx:{color:"#6B6B6B"},children:["Phone: ",f.phone]}),f.email&&t.jsxs(s,{variant:"body2",sx:{color:"#6B6B6B"},children:["Email: ",f.email]})]})})]}),t.jsx(r,{sx:{mb:4},children:t.jsxs(c,{container:!0,spacing:2,sx:{mb:3},children:[t.jsx(c,{item:!0,xs:12,sm:6,md:3,children:t.jsxs(r,{sx:{p:2,borderRadius:2,bgcolor:"rgba(75, 111, 68, 0.05)",border:"1px solid rgba(75, 111, 68, 0.1)"},children:[t.jsx(s,{variant:"body2",sx:{color:"#8B8B8B",mb:.5,fontWeight:600},children:"Invoice Number"}),t.jsxs(s,{variant:"h6",sx:{fontWeight:700,color:"#4b6f44",wordBreak:"break-word",overflowWrap:"break-word",fontSize:{xs:"0.9rem",md:"1.25rem"}},children:["#",h.order_id]})]})}),t.jsx(c,{item:!0,xs:12,sm:6,md:3,children:t.jsxs(r,{sx:{p:2,borderRadius:2,bgcolor:"rgba(75, 111, 68, 0.05)",border:"1px solid rgba(75, 111, 68, 0.1)"},children:[t.jsx(s,{variant:"body2",sx:{color:"#8B8B8B",mb:.5,fontWeight:600},children:"Invoice Date"}),t.jsx(s,{variant:"h6",sx:{fontWeight:700,color:"#4b6f44"},children:g})]})}),t.jsx(c,{item:!0,xs:12,sm:6,md:3,children:t.jsxs(r,{sx:{p:2,borderRadius:2,bgcolor:"rgba(75, 111, 68, 0.05)",border:"1px solid rgba(75, 111, 68, 0.1)"},children:[t.jsx(s,{variant:"body2",sx:{color:"#8B8B8B",mb:.5,fontWeight:600},children:"Payment Method"}),t.jsx(s,{variant:"h6",sx:{fontWeight:700,color:"#4b6f44",textTransform:"capitalize"},children:h.payment_method||"N/A"})]})}),t.jsx(c,{item:!0,xs:12,sm:6,md:3,children:t.jsxs(r,{sx:{p:2,borderRadius:2,bgcolor:"rgba(75, 111, 68, 0.05)",border:"1px solid rgba(75, 111, 68, 0.1)"},children:[t.jsx(s,{variant:"body2",sx:{color:"#8B8B8B",mb:.5,fontWeight:600},children:"Status"}),t.jsx(x,{label:h.payment_status||"Paid",sx:{bgcolor:"paid"===h.payment_status?"rgba(0, 200, 81, 0.1)":"rgba(255, 136, 0, 0.1)",color:"paid"===h.payment_status?"#00C851":"#FF8800",fontWeight:600,textTransform:"capitalize"}})]})})]})}),t.jsxs(r,{sx:{mb:4},children:[t.jsx(s,{variant:"h6",sx:{fontWeight:700,color:"#4b6f44",mb:2,fontFamily:'"Inter", sans-serif'},children:"Items"}),t.jsxs(r,{sx:{border:"1px solid rgba(75, 111, 68, 0.1)",borderRadius:2,overflow:"hidden"},children:[t.jsxs(r,{sx:{bgcolor:"rgba(75, 111, 68, 0.05)",p:2,borderBottom:"1px solid rgba(75, 111, 68, 0.1)",display:{xs:"none",md:"flex"},gap:2},children:[t.jsx(r,{sx:{flex:2},children:t.jsx(s,{variant:"body2",sx:{fontWeight:600,color:"#4b6f44"},children:"Item"})}),t.jsx(r,{sx:{flex:1,textAlign:"center"},children:t.jsx(s,{variant:"body2",sx:{fontWeight:600,color:"#4b6f44"},children:"Quantity"})}),t.jsx(r,{sx:{flex:1,textAlign:"right"},children:t.jsx(s,{variant:"body2",sx:{fontWeight:600,color:"#4b6f44"},children:"Price"})}),t.jsx(r,{sx:{flex:1,textAlign:"right"},children:t.jsx(s,{variant:"body2",sx:{fontWeight:600,color:"#4b6f44"},children:"Total"})})]}),u.map((e,n)=>t.jsx(r,{sx:{p:2,borderBottom:n<u.length-1?"1px solid rgba(75, 111, 68, 0.1)":"none","&:hover":{bgcolor:"rgba(75, 111, 68, 0.02)"}},children:t.jsxs(c,{container:!0,spacing:2,alignItems:"center",children:[t.jsxs(c,{item:!0,xs:12,md:6,children:[t.jsx(s,{variant:"body1",sx:{fontWeight:600,color:"#4b6f44",mb:.5},children:e.name}),e.selected_variants&&Object.keys(e.selected_variants).length>0&&t.jsx(r,{sx:{display:"flex",gap:.5,flexWrap:"wrap",mt:.5},children:Object.entries(e.selected_variants).map(([e,r])=>t.jsx(x,{label:`${e}: ${r}`,size:"small",sx:{fontSize:"0.7rem",height:20,bgcolor:"#F5F5F5",color:"#6B6B6B"}},e))})]}),t.jsx(c,{item:!0,xs:4,md:2,children:t.jsxs(s,{variant:"body2",sx:{color:"#6B6B6B",textAlign:{xs:"left",md:"center"}},children:["Qty: ",e.quantity]})}),t.jsx(c,{item:!0,xs:4,md:2,children:t.jsxs(s,{variant:"body2",sx:{color:"#6B6B6B",textAlign:{xs:"left",md:"right"}},children:["₹",Number(e.price||0).toLocaleString()]})}),t.jsx(c,{item:!0,xs:4,md:2,children:t.jsxs(s,{variant:"body1",sx:{fontWeight:600,color:"#4b6f44",textAlign:{xs:"left",md:"right"}},children:["₹",Number(e.total_price||e.price*e.quantity||0).toLocaleString()]})})]})},n))]})]}),t.jsx(r,{sx:{p:4,borderRadius:2,bgcolor:"rgba(75, 111, 68, 0.05)",border:"1px solid rgba(75, 111, 68, 0.1)"},children:t.jsxs(i,{spacing:2,children:[t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(s,{variant:"h6",sx:{color:"#6B6B6B",fontWeight:600},children:"Subtotal:"}),t.jsxs(s,{variant:"h6",sx:{fontWeight:700,color:"#4b6f44"},children:["₹",Number(p.subtotal||0).toLocaleString()]})]}),p.discount>0&&t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(s,{variant:"h6",sx:{color:"#6B6B6B",fontWeight:600},children:"Discount:"}),t.jsxs(s,{variant:"h6",sx:{fontWeight:700,color:"#E94560"},children:["-₹",Number(p.discount||0).toLocaleString()]})]}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(s,{variant:"h6",sx:{color:"#6B6B6B",fontWeight:600},children:"Shipping:"}),t.jsx(s,{variant:"h6",sx:{fontWeight:700,color:0===p.shipping?"#00C851":"#4b6f44"},children:0===p.shipping?"Free":`₹${Number(p.shipping||0).toLocaleString()}`})]}),t.jsx(l,{sx:{my:1,borderColor:"rgba(75, 111, 68, 0.2)"}}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2.5,borderRadius:2,bgcolor:"rgba(233, 69, 96, 0.1)",border:"2px solid rgba(233, 69, 96, 0.2)"},children:[t.jsx(s,{variant:"h5",sx:{fontWeight:700,color:"#4b6f44"},children:"Total:"}),t.jsxs(s,{variant:"h5",sx:{fontWeight:700,color:"#E94560"},children:["₹",Number(p.total||h.total_amount||0).toLocaleString()]})]})]})}),t.jsx(r,{sx:{mt:4,textAlign:"center"},children:t.jsx(s,{variant:"body2",sx:{color:"#8B8B8B",fontStyle:"italic"},children:"Thank you for your purchase! This is a computer-generated invoice and does not require a signature."})})]})},$=t=>null==t?"—":`₹${Number(t).toLocaleString()}`,I=({label:e,value:n,bold:i=!1})=>t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",color:"#2f3b31"},children:[t.jsx(s,{sx:{fontWeight:i?700:500},children:e}),t.jsx(s,{sx:{fontWeight:i?800:600},children:$(n)})]}),F=()=>{const{orderId:a}=w(),d=B(),{clearCart:c,clearCartFromServer:W}=j(),[S,F]=h.useState(null),[_,C]=h.useState(!0),[N,P]=h.useState(null);h.useEffect(()=>{a&&T()},[a]);const T=async()=>{try{C(!0),P(null);const t=await v.get(`/orders/${a}`);t.data.success?(F(t.data.order),c(),W()):P("Order not found")}catch(t){P(t.response?.data?.message||"Failed to load order details")}finally{C(!1)}};if(_)return t.jsx(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh"},children:t.jsx(b,{sx:{color:"#4b6f44"}})});if(N)return t.jsxs(r,{sx:{width:"100%",maxWidth:720,mx:"auto",mt:6,px:{xs:2,sm:3},py:4},children:[t.jsx(m,{severity:"error",sx:{mb:2,borderRadius:2},children:N}),t.jsx(o,{variant:"contained",onClick:()=>d("/"),startIcon:t.jsx(g,{}),children:"Back to Home"})]});if(!S)return null;const D=((t,e)=>t?t.startsWith("http")?t:`${y}${t}`:e?`${y}/store/${u}/orders/${e}/invoice`:null)(S.invoice_url,S.order_id),z=S.order_summary||{};return t.jsx(r,{sx:{minHeight:"100vh",backgroundColor:"#f7f6f3",py:{xs:4,md:6},mt:{xs:"90px",sm:"90px",md:"70px"}},children:t.jsxs(f,{maxWidth:"md",sx:{px:{xs:2,sm:3}},children:[t.jsxs(e,{sx:{p:{xs:3,md:4},mb:3,borderRadius:3,boxShadow:"0 10px 30px rgba(0,0,0,0.06)",background:"#fff",textAlign:"center"},children:[t.jsx(s,{variant:"h4",sx:{fontWeight:800,color:"#2f3b31",mb:1,mt:2},children:"Order Confirmed"}),t.jsxs(s,{variant:"body1",sx:{color:"#5b625c",mb:3},children:["Thanks for your purchase! A confirmation was sent to ",S.customer_details?.email||"your email","."]}),t.jsxs(i,{direction:{xs:"column",sm:"row"},spacing:1,justifyContent:"center",alignItems:"center",sx:{mb:3},children:[t.jsx(x,{label:`Order #${S.order_id}`,sx:{fontWeight:700,bgcolor:"#f1f5f3"}}),t.jsx(x,{label:`Total ${z.total?$(z.total):"—"}`,sx:{fontWeight:700,bgcolor:"#f1f5f3"}}),t.jsx(x,{label:`Payment: ${S.payment_method||"—"}`,sx:{fontWeight:700,bgcolor:"#f1f5f3",textTransform:"capitalize"}})]}),t.jsxs(i,{direction:{xs:"column",sm:"row"},spacing:1.5,justifyContent:"center",children:[D&&t.jsxs(t.Fragment,{children:[t.jsx(o,{variant:"contained",startIcon:t.jsx(n,{}),sx:{background:"#e94560","&:hover":{background:"#d53c54"}},onClick:()=>{const t=document.querySelector("[data-invoice-download]");t?t.parentElement?.click():window.open(D,"_blank")},children:"Download PDF"}),t.jsx(o,{variant:"outlined",startIcon:t.jsx(p,{}),sx:{borderColor:"#4b6f44",color:"#4b6f44"},onClick:()=>{const t=document.querySelector("[data-invoice-print]");t?t.parentElement?.click():window.open(D,"_blank")},children:"Print / Save PDF"})]}),t.jsx(o,{variant:"text",startIcon:t.jsx(g,{}),onClick:()=>d("/"),sx:{color:"#4b6f44",fontWeight:700},children:"Continue Shopping"})]})]}),t.jsx(e,{sx:{p:{xs:3,md:4},borderRadius:3,boxShadow:"0 10px 30px rgba(0,0,0,0.05)",background:"#fff",mb:3},children:t.jsxs(i,{spacing:2,children:[t.jsx(s,{variant:"h6",sx:{fontWeight:700,color:"#2f3b31"},children:"Order Summary"}),S.items?.map((e,n)=>t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:1,borderBottom:"1px solid #f1f1f1"},children:[t.jsxs(r,{children:[t.jsx(s,{sx:{fontWeight:600,color:"#2f3b31"},children:e.name||e.product_name||"Product"}),t.jsxs(s,{sx:{color:"#6b6b6b",fontSize:14},children:["Qty: ",e.quantity]})]}),t.jsx(s,{sx:{fontWeight:700,color:"#2f3b31"},children:$(e.price*e.quantity)})]},`${e.product_id}-${n}`)),t.jsx(l,{}),t.jsxs(i,{spacing:1,children:[t.jsx(I,{label:"Subtotal",value:z.subtotal}),t.jsx(I,{label:"Shipping",value:z.shipping}),t.jsx(I,{label:"Tax",value:z.tax}),t.jsx(I,{label:"Discount",value:z.discount?-z.discount:0}),t.jsx(l,{}),t.jsx(I,{label:"Total Paid",value:z.total,bold:!0})]})]})}),S&&t.jsx(e,{sx:{p:{xs:3,md:4},borderRadius:3,boxShadow:"0 10px 30px rgba(0,0,0,0.05)",background:"#fff"},children:t.jsx(k,{order:S})})]})})};export{F as default};
