import{a as e,r as s,j as t,B as r,aE as o,I as n,av as a,T as i,aF as l,aG as c,P as d,e as x,b as m,aA as f,aC as u,Q as h,g as p,f as g,aH as j,F as y,aI as b,aJ as v,aK as S,aL as z,aM as C,d as W,aN as _,t as w,D as I,k as R,n as P,v as k,a7 as O,A as E}from"./mui-CZF-0V7l.js";import{R as N,u as F,a as $,b as T}from"./index-CM2p59Wv.js";import{u as D}from"./router-C8FM2-5r.js";import"./vendor-HnKmhvXM.js";import"./utils-BLtjaFjY.js";const M="checkout_form_data",A=()=>{const A=D(),q=F();e("(max-width:768px)");const{cartItems:L,getCartTotal:U,isLoggedIn:K,customerData:H,updateCartItem:J,removeFromCart:Y,clearCart:B,clearCartFromServer:V,loadCart:Q}=$(),Z=e=>{try{localStorage.setItem(M,JSON.stringify(e))}catch(s){}},G=()=>{try{const e=localStorage.getItem(M);return e?JSON.parse(e):null}catch(e){return null}},X=()=>{try{localStorage.removeItem(M)}catch(e){}},[ee,se]=s.useState(!1),[te,re]=s.useState({open:!1,message:"",severity:"success"}),[oe,ne]=s.useState({firstName:"",lastName:"",country:"India",address1:"",address2:"",city:"",state:"",pincode:"",phone:"",email:""}),[ae,ie]=s.useState("online"),[le,ce]=s.useState(!1),[de,xe]=s.useState({subtotal:0,shipping:0,tax:0,discount:0,total:0}),[me,fe]=s.useState(""),[ue,he]=s.useState(null),[pe,ge]=s.useState(""),[je,ye]=s.useState(!1),[be,ve]=s.useState(!1),[Se,ze]=s.useState(!1),[Ce,We]=s.useState(!1),[_e,we]=s.useState(""),[Ie,Re]=s.useState(""),[Pe,ke]=s.useState(!1),[Oe,Ee]=s.useState(""),[Ne,Fe]=s.useState(600);s.useEffect(()=>{K&&(ke(!0),ve(!1))},[K]),s.useEffect(()=>{$e()},[L,ue]),s.useEffect(()=>{const e=G();e&&(ne(s=>({...s,...e})),e.paymentMethod&&ie(e.paymentMethod),void 0!==e.termsAccepted&&ce(e.termsAccepted))},[]),s.useEffect(()=>{H&&K&&ne(e=>({...e,firstName:H.firstName||e.firstName,lastName:H.lastName||e.lastName,email:H.email||e.email,phone:H.phone||e.phone}))},[H,K]),s.useEffect(()=>{K||X()},[K]),s.useEffect(()=>{const e=setInterval(()=>{Fe(s=>s<=1?(clearInterval(e),0):s-1)},1e3);return()=>clearInterval(e)},[]);const $e=()=>{const e=U(),s=ue?ue.discount_amount:0,t=Math.max(0,e+0+0-s);xe({subtotal:e,shipping:0,tax:0,discount:s,total:t})},Te=async()=>{if(me.trim()){ye(!0),ge("");try{const e=await T.post("/coupon/validate",{coupon_code:me.trim().toUpperCase(),order_total:U()});e.data.success?(he(e.data.coupon),ge(""),re({open:!0,message:"Coupon applied successfully!",severity:"success"})):(ge(e.data.error||"Invalid coupon code"),he(null))}catch(e){ge(e.response?.data?.error||"Failed to validate coupon"),he(null)}finally{ye(!1)}}else ge("Please enter a coupon code")},De=e=>{const{name:s,value:t,type:r,checked:o}=e.target,n={...oe,[s]:"checkbox"===r?o:t};ne(n),Z(n)},Me=async()=>{if(oe.email.trim())try{ze(!0);const e=await T.post("/customer/send-otp",{email:oe.email.trim(),name:`${oe.firstName} ${oe.lastName}`.trim()||void 0});if(!e.data.success)throw new Error(e.data.error||"Failed to send OTP");Re(e.data.otp_token),ve(!0),Ee("We sent an OTP to your email. Please enter it to continue."),re({open:!0,message:"OTP sent to your email",severity:"success"})}catch(e){re({open:!0,message:e.response?.data?.error||e.message||"Failed to send OTP",severity:"error"})}finally{ze(!1)}else re({open:!0,message:"Please provide an email before continuing",severity:"error"})},Ae=async()=>{se(!0);try{const t={customer_details:{firstName:oe.firstName.trim(),lastName:oe.lastName.trim(),email:oe.email.trim(),phone:oe.phone.trim(),address:`${oe.address1.trim()}${oe.address2?", "+oe.address2.trim():""}, ${oe.city.trim()}, ${oe.state.trim()} ${oe.pincode.trim()}, ${oe.country}`},payment_method:"online"===ae?"razorpay":"cod",items:L.map(e=>({product_id:e.product_id,quantity:e.quantity||1,price:e.price||0,selected_variants:e.selected_variants||e.variants||{}})).filter(e=>e.product_id&&e.quantity>0&&e.price>0),coupon_code:ue?ue.coupon_code:null,discount_amount:ue?ue.discount_amount:0};if(!t.items||0===t.items.length)throw new Error("No valid items in cart. Please check your cart items.");const r=await T.post("/order",t);if(!r.data.success)throw new Error(r.data.error||"Failed to create order");{const t=r.data.order_id;try{K?(await V(),await Q()):B()}catch(e){}if("cod"===ae)return X(),void A(`/order-success/${t}`);if("online"===ae)try{const e={amount:de.total,customer_name:`${oe.firstName} ${oe.lastName}`,customer_email:oe.email,customer_phone:oe.phone,order_id:t,description:`Order #${t} - Souk and Stitch`},s=await(async e=>new Promise((s,t)=>{if(void 0===window.Razorpay)return void t(new Error("Razorpay SDK not loaded"));const r={key:N.key_id,amount:100*e.amount,currency:N.currency,name:N.name,description:e.description||N.description,handler:function(e){s({success:!0,payment_id:e.razorpay_payment_id,order_id:e.razorpay_order_id,signature:e.razorpay_signature})},prefill:{name:e.customer_name,email:e.customer_email,contact:e.customer_phone},notes:{order_id:e.order_id},theme:N.theme,modal:{ondismiss:function(){t(new Error("Payment cancelled by user"))}}};new window.Razorpay(r).open()}))(e);s.success&&(X(),A(`/order-success/${t}`))}catch(s){if("Payment cancelled by user"!==s.message)throw s;re({open:!0,message:"Payment was cancelled",severity:"warning"})}}}catch(t){const e=t.response?.data?.error||t.response?.data?.message||t.message||"Failed to place order";re({open:!0,message:e,severity:"error"})}finally{se(!1)}};return t.jsxs(r,{sx:{minHeight:"100vh",bgcolor:"#f8f9fa",py:4},children:[t.jsxs(o,{maxWidth:"xl",children:[t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[t.jsx(n,{onClick:()=>A("/"),sx:{bgcolor:"#ffffff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)","&:hover":{bgcolor:"#f5f5f5"}},children:t.jsx(a,{})}),t.jsx(i,{variant:"h4",sx:{fontWeight:600,color:"#333",fontFamily:"Inter, sans-serif"},children:"Checkout"})]}),t.jsxs(r,{sx:{mb:4},children:[t.jsx(l,{variant:"determinate",value:75,sx:{height:6,borderRadius:3,bgcolor:"#e9ecef","& .MuiLinearProgress-bar":{borderRadius:3,bgcolor:"#e74c3c"}}}),t.jsx(i,{sx:{mt:1,fontSize:"0.9rem",color:"#666",textAlign:"center"},children:"Shipping and Checkout"})]}),Ne>0&&t.jsx(r,{sx:{bgcolor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:2,p:2,mb:4,textAlign:"center"},children:t.jsxs(i,{sx:{color:"#856404",fontWeight:600,fontSize:"0.95rem"},children:["Your order is reserved for: ",(qe=Ne,`${Math.floor(qe/60)}:${(qe%60).toString().padStart(2,"0")}`)]})}),t.jsxs(c,{container:!0,spacing:4,sx:{display:"flex",flexWrap:"wrap"},children:[t.jsx(c,{item:!0,xs:12,sm:12,md:8,lg:8,sx:{display:"flex",flexDirection:"column"},children:t.jsxs(d,{sx:{p:4,borderRadius:2},children:[!K&&t.jsx(r,{sx:{mb:3,textAlign:"center"},children:t.jsxs(i,{sx:{color:"#666",fontSize:"0.9rem"},children:["Returning customer?",t.jsx(x,{variant:"text",sx:{ml:1,p:0,minWidth:"auto",textTransform:"none",color:"#e74c3c",fontWeight:600},children:"Click here to login"})]})}),t.jsx(i,{variant:"h5",sx:{fontWeight:600,color:"#333",mb:3,fontFamily:"Inter, sans-serif"},children:"Billing details"}),t.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:3},children:[t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["First name ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(m,{fullWidth:!0,name:"firstName",value:oe.firstName,onChange:De,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Last name ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(m,{fullWidth:!0,name:"lastName",value:oe.lastName,onChange:De,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Country / Region ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(f,{fullWidth:!0,size:"small",children:t.jsxs(u,{name:"country",value:oe.country,onChange:De,sx:{borderRadius:1,bgcolor:"#ffffff"},children:[t.jsx(h,{value:"India",children:"India"}),t.jsx(h,{value:"United States",children:"United States (US)"}),t.jsx(h,{value:"United Kingdom",children:"United Kingdom (UK)"}),t.jsx(h,{value:"Canada",children:"Canada"}),t.jsx(h,{value:"Australia",children:"Australia"})]})})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Street address ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(m,{fullWidth:!0,name:"address1",value:oe.address1,onChange:De,required:!0,variant:"outlined",size:"small",placeholder:"House number and street name",sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}}),t.jsx(m,{fullWidth:!0,name:"address2",value:oe.address2,onChange:De,variant:"outlined",size:"small",placeholder:"Apartment, suite, unit, etc. (optional)",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Town / City ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(m,{fullWidth:!0,name:"city",value:oe.city,onChange:De,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["State ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(m,{fullWidth:!0,name:"state",value:oe.state,onChange:De,required:!0,variant:"outlined",size:"small",placeholder:"Enter your state",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["ZIP Code ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(m,{fullWidth:!0,name:"pincode",value:oe.pincode,onChange:De,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Phone ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(m,{fullWidth:!0,name:"phone",value:oe.phone,onChange:De,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Email address ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(m,{fullWidth:!0,name:"email",type:"email",value:oe.email,onChange:De,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]})]})]})}),t.jsx(c,{item:!0,xs:12,sm:12,md:4,lg:4,sx:{display:"flex",flexDirection:"column"},children:t.jsxs(d,{sx:{p:4,borderRadius:2,position:"sticky",top:20,bgcolor:"#ffffff"},children:[t.jsx(i,{variant:"h5",sx:{fontWeight:600,color:"#333",mb:3,fontFamily:"Inter, sans-serif"},children:"Your order"}),t.jsx(r,{sx:{mb:3},children:L.map(e=>t.jsxs(r,{sx:{display:"flex",gap:2,mb:2,pb:2,borderBottom:"1px solid #eee"},children:[t.jsx(r,{sx:{width:50,height:50,borderRadius:1,overflow:"hidden",flexShrink:0,bgcolor:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:(()=>{const s=e.image_url||e.image||`https://soukandstiches.mycartly.in/uploads/products/1532365/${e.product_id}_v1.png`;return t.jsx("img",{src:s,alt:e.product_name||e.name,style:{width:"100%",height:"100%",objectFit:"cover"},onError:s=>{s.target.src.includes("_v1.png")?s.target.src.includes("_v2.png")?s.target.style.display="none":s.target.src=`https://soukandstiches.mycartly.in/uploads/products/1532365/${e.product_id}_v2.png`:s.target.src=`https://soukandstiches.mycartly.in/uploads/products/1532365/${e.product_id}_v1.png`}})})()}),t.jsxs(r,{sx:{flex:1},children:[t.jsx(i,{sx:{fontSize:"0.9rem",fontWeight:500,color:"#333",mb:.5},children:e.product_name||e.name}),e.variants&&Object.keys(e.variants).length>0&&t.jsx(i,{sx:{fontSize:"0.75rem",color:"#666",mb:.5},children:Object.entries(e.variants).map(([e,s])=>t.jsxs("span",{style:{marginRight:"8px"},children:[t.jsxs("strong",{children:[e,":"]})," ",s]},e))}),(!e.variants||0===Object.keys(e.variants).length)&&e.selected_variants&&Object.keys(e.selected_variants).length>0&&t.jsx(i,{sx:{fontSize:"0.75rem",color:"#666",mb:.5},children:Object.entries(e.selected_variants).map(([e,s])=>t.jsxs("span",{style:{marginRight:"8px"},children:[t.jsxs("strong",{children:[e,":"]})," ",s]},e))}),t.jsxs(i,{sx:{fontSize:"0.8rem",color:"#666",mb:.5},children:["Qty: ",e.quantity]}),t.jsxs(i,{sx:{fontSize:"0.9rem",fontWeight:600,color:"#333"},children:["₹",(e.price*e.quantity).toLocaleString()]})]})]},e.id))}),t.jsx(p,{sx:{my:3}}),t.jsxs(r,{sx:{mb:3},children:[t.jsx(i,{variant:"h6",sx:{fontWeight:600,color:"#333",mb:2},children:"Coupon Code"}),ue?t.jsxs(r,{sx:{p:2,bgcolor:"#e8f5e9",borderRadius:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(r,{children:[t.jsx(i,{sx:{fontWeight:600,color:"#2e7d32"},children:ue.coupon_code}),t.jsxs(i,{sx:{fontSize:"0.8rem",color:"#666"},children:["Discount: ₹",ue.discount_amount.toFixed(2)]})]}),t.jsx(x,{size:"small",onClick:()=>{he(null),fe(""),ge("")},sx:{color:"#d32f2f"},children:"Remove"})]}):t.jsxs(r,{sx:{display:"flex",gap:1},children:[t.jsx(m,{fullWidth:!0,size:"small",placeholder:"Enter coupon code",value:me,onChange:e=>{fe(e.target.value.toUpperCase()),ge("")},onKeyPress:e=>{"Enter"===e.key&&Te()},error:!!pe,helperText:pe,sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}}),t.jsx(x,{variant:"contained",onClick:Te,disabled:je||!me.trim(),sx:{bgcolor:"#4b6f44","&:hover":{bgcolor:"#3a5635"},minWidth:100},children:je?t.jsx(g,{size:20}):"Apply"})]})]}),t.jsxs(r,{sx:{mb:3},children:[t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[t.jsx(i,{sx:{fontSize:"0.9rem",color:"#333"},children:"Subtotal"}),t.jsxs(i,{sx:{fontSize:"0.9rem",color:"#333"},children:["₹",de.subtotal.toLocaleString()]})]}),de.discount>0&&t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[t.jsx(i,{sx:{fontSize:"0.9rem",color:"#2e7d32"},children:"Discount"}),t.jsxs(i,{sx:{fontSize:"0.9rem",color:"#2e7d32",fontWeight:600},children:["-₹",de.discount.toFixed(2)]})]}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[t.jsx(i,{sx:{fontSize:"0.9rem",color:"#333"},children:"Shipping"}),t.jsx(i,{sx:{fontSize:"0.9rem",color:"#333"},children:0===de.shipping?"FREE":`₹${de.shipping}`})]}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[t.jsx(i,{sx:{fontSize:"0.9rem",color:"#333"},children:"Tax"}),t.jsxs(i,{sx:{fontSize:"0.9rem",color:"#333"},children:["₹",de.tax.toLocaleString()]})]}),t.jsx(p,{sx:{my:2}}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[t.jsx(i,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:"Total"}),t.jsxs(i,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:["₹",de.total.toLocaleString()]})]})]}),t.jsx(i,{variant:"h6",sx:{fontWeight:600,color:"#333",mb:2},children:"Payment"}),t.jsx(f,{component:"fieldset",fullWidth:!0,children:t.jsxs(j,{value:ae,onChange:e=>{const s=e.target.value;ie(s);const t=G()||{};Z({...t,paymentMethod:s})},children:[t.jsx(y,{value:"online",control:t.jsx(z,{sx:{color:"#e74c3c"}}),label:t.jsxs(r,{children:[t.jsx(i,{sx:{fontWeight:500},children:"Online Payment"}),t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5,flexWrap:"wrap"},children:[t.jsx(i,{sx:{fontSize:"0.8rem",color:"#666"},children:"Pay securely with"}),t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:.5,px:1,py:.25,borderRadius:999,bgcolor:"rgba(47, 141, 70, 0.12)"},children:[t.jsx(b,{sx:{fontSize:18,color:"#2F8D46"}}),t.jsx(i,{sx:{fontSize:"0.75rem",color:"#2F8D46",fontWeight:600},children:"UPI"})]}),t.jsx(i,{sx:{fontSize:"0.8rem",color:"#666"},children:","}),t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:.5,px:1,py:.25,borderRadius:999,bgcolor:"rgba(26, 31, 113, 0.12)"},children:[t.jsx(v,{sx:{fontSize:18,color:"#1A73E8"}}),t.jsx(i,{sx:{fontSize:"0.75rem",color:"#1A1F71",fontWeight:600},children:"Cards"})]}),t.jsx(i,{sx:{fontSize:"0.8rem",color:"#666"},children:"or"}),t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:.5,px:1,py:.25,borderRadius:999,bgcolor:"rgba(95, 37, 159, 0.12)"},children:[t.jsx(S,{sx:{fontSize:18,color:"#5F259F"}}),t.jsx(i,{sx:{fontSize:"0.75rem",color:"#5F259F",fontWeight:600},children:"Wallets"})]})]})]})}),t.jsx(y,{value:"cod",control:t.jsx(z,{sx:{color:"#e74c3c"}}),label:t.jsxs(r,{children:[t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(i,{sx:{fontWeight:500},children:"Cash on Delivery (COD)"}),t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:.5,px:1,py:.25,borderRadius:999,bgcolor:"rgba(233, 69, 96, 0.12)"},children:[t.jsx(C,{sx:{fontSize:18,color:"#E94560"}}),t.jsx(i,{sx:{fontSize:"0.75rem",color:"#E94560",fontWeight:600},children:"Pay on Delivery"})]})]}),t.jsx(i,{sx:{fontSize:"0.8rem",color:"#666",mt:.5},children:"Pay cash when your order is delivered"})]}),sx:{mt:2}})]})}),t.jsx(r,{sx:{my:3},children:t.jsx(y,{control:t.jsx(W,{checked:le,onChange:e=>{const s=e.target.checked;ce(s);const t=G()||{};Z({...t,termsAccepted:s})},sx:{color:"#e74c3c"}}),label:t.jsxs(i,{sx:{fontSize:"0.9rem"},children:["I have read and agree to the website"," ",t.jsx(x,{variant:"text",onClick:()=>q("/terms-and-conditions",{},{reloadOn:["/terms-and-conditions"]}),sx:{p:0,minWidth:"auto",textTransform:"none",color:"#e74c3c",fontWeight:600,textDecoration:"underline"},children:"terms and conditions"})," ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]})})}),t.jsx(x,{fullWidth:!0,variant:"contained",size:"large",onClick:async()=>{if(!(()=>{const e=["firstName","lastName","address1","city","state","pincode","phone","email"];for(let s of e)if(!oe[s].trim())return re({open:!0,message:`Please fill in ${s.replace(/([A-Z])/g," $1").toLowerCase()}`,severity:"error"}),!1;return!!le||(re({open:!0,message:"Please accept the terms and conditions",severity:"error"}),!1)})())return;if(!L||0===L.length)return void re({open:!0,message:"Your cart is empty. Please add items before placing an order.",severity:"error"});if(!K&&!Pe)return await Me(),void se(!1);await Ae()},disabled:ee||!le,startIcon:ee?t.jsx(g,{size:20}):t.jsx(_,{}),sx:{bgcolor:"#28a745",color:"#ffffff",py:1.5,fontSize:"1rem",fontWeight:600,borderRadius:2,"&:hover":{bgcolor:"#218838"},"&:disabled":{bgcolor:"#e9ecef",color:"#6c757d"}},children:ee?"Processing...":"cod"===ae?"Place Order":"Proceed to Pay"}),t.jsxs(r,{sx:{mt:3,display:"flex",flexWrap:"wrap",gap:1,justifyContent:"center"},children:[t.jsx(w,{label:"100% SECURE",size:"small",sx:{bgcolor:"#e8f5e8",color:"#28a745",fontWeight:600,fontSize:"0.7rem"}}),t.jsx(w,{label:"SSL ENCRYPTED",size:"small",sx:{bgcolor:"#e8f5e8",color:"#28a745",fontWeight:600,fontSize:"0.7rem"}}),t.jsx(w,{label:"TRUSTED",size:"small",sx:{bgcolor:"#e8f5e8",color:"#28a745",fontWeight:600,fontSize:"0.7rem"}})]}),t.jsxs(r,{sx:{mt:4,p:3,bgcolor:"#f8f9fa",borderRadius:2,textAlign:"center"},children:[t.jsx(i,{sx:{fontSize:"0.8rem",color:"#666",fontStyle:"italic",mb:1},children:'"The quality of the customer service and speed of delivery was just fantastic - I know I can count on Souk and Stitch every time!"'}),t.jsx(i,{sx:{fontSize:"0.75rem",color:"#999",fontWeight:500},children:"- Happy Customer"})]})]})})]})]}),t.jsxs(I,{open:be,onClose:()=>ve(!1),maxWidth:"xs",fullWidth:!0,children:[t.jsx(R,{children:"Email Verification"}),t.jsxs(P,{dividers:!0,children:[t.jsx(i,{variant:"body2",sx:{mb:2},children:Oe||"Enter the OTP sent to your email to continue."}),t.jsx(m,{fullWidth:!0,label:"OTP",value:_e,onChange:e=>we(e.target.value),margin:"dense",inputProps:{maxLength:6}})]}),t.jsxs(k,{sx:{px:3,pb:2},children:[t.jsx(x,{onClick:Me,disabled:Se,children:Se?"Resending...":"Resend OTP"}),t.jsx(x,{variant:"contained",onClick:async()=>{if(_e.trim()&&Ie)try{We(!0);const e=await T.post("/customer/verify-otp",{email:oe.email.trim(),otp:_e.trim(),otp_token:Ie});if(!e.data.success)throw new Error(e.data.error||"Wrong OTP, please re-enter");ke(!0),ve(!1),re({open:!0,message:"Email verified successfully!",severity:"success"}),e.data.token&&(localStorage.setItem("customer_token",e.data.token),localStorage.setItem("customer_data",JSON.stringify({email:oe.email.trim(),name:`${oe.firstName} ${oe.lastName}`.trim()||"Customer"}))),await Ae()}catch(e){re({open:!0,message:e.response?.data?.error||e.message||"Wrong OTP, please re-enter",severity:"error"})}finally{We(!1)}else re({open:!0,message:"Please enter the OTP",severity:"error"})},disabled:Ce,children:Ce?"Verifying...":"Verify & Continue"})]})]}),t.jsx(O,{open:te.open,autoHideDuration:6e3,onClose:()=>re({...te,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(E,{onClose:()=>re({...te,open:!1}),severity:te.severity,sx:{width:"100%",borderRadius:2},children:te.message})})]});var qe};export{A as default};
