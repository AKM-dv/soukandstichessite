import{a as e,r as s,j as t,B as r,ax as o,I as n,ao as a,T as i,ay as l,az as c,P as d,k as f,h as x,as as h,au as m,av as u,w as p,aA as g,aB as j,aC as y,aD as b,C as v,aE as S,v as z,a1 as W,A as C}from"./mui-BFxyK2dR.js";import{R as w,u as I,a as _}from"./index-CfRD-3Fw.js";import{u as R}from"./router-Di7NXMu_.js";import"./vendor-HnKmhvXM.js";import"./utils-C0SGC0PE.js";const N="checkout_form_data",k=()=>{const k=R();e("(max-width:768px)");const{cartItems:E,getCartTotal:P,isLoggedIn:$,customerData:O,updateCartItem:M,removeFromCart:q}=I(),A=e=>{try{localStorage.setItem(N,JSON.stringify(e))}catch(s){}},D=()=>{try{const e=localStorage.getItem(N);return e?JSON.parse(e):null}catch(e){return null}},T=()=>{try{localStorage.removeItem(N)}catch(e){}},[F,L]=s.useState(!1),[U,B]=s.useState({open:!1,message:"",severity:"success"}),[H,K]=s.useState({firstName:"",lastName:"",country:"India",address1:"",address2:"",city:"",state:"",pincode:"",phone:"",email:""}),[Y,J]=s.useState("cod"),[Z,Q]=s.useState(!1),[G,V]=s.useState({subtotal:0,shipping:0,tax:0,total:0}),[X,ee]=s.useState(600);s.useEffect(()=>{se()},[E]),s.useEffect(()=>{const e=D();e&&(K(s=>({...s,...e})),e.paymentMethod&&J(e.paymentMethod),void 0!==e.termsAccepted&&Q(e.termsAccepted))},[]),s.useEffect(()=>{O&&$&&K(e=>({...e,firstName:O.firstName||e.firstName,lastName:O.lastName||e.lastName,email:O.email||e.email,phone:O.phone||e.phone}))},[O,$]),s.useEffect(()=>{$||T()},[$]),s.useEffect(()=>{const e=setInterval(()=>{ee(s=>s<=1?(clearInterval(e),0):s-1)},1e3);return()=>clearInterval(e)},[]);const se=()=>{const e=P(),s=e>999?0:99;V({subtotal:e,shipping:s,tax:0,total:e+s+0})},te=e=>{const{name:s,value:t,type:r,checked:o}=e.target,n={...H,[s]:"checkbox"===r?o:t};K(n),A(n)};return t.jsxs(r,{sx:{minHeight:"100vh",bgcolor:"#f8f9fa",py:4},children:[t.jsxs(o,{maxWidth:"xl",children:[t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[t.jsx(n,{onClick:()=>k("/"),sx:{bgcolor:"#ffffff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)","&:hover":{bgcolor:"#f5f5f5"}},children:t.jsx(a,{})}),t.jsx(i,{variant:"h4",sx:{fontWeight:600,color:"#333",fontFamily:"Inter, sans-serif"},children:"Checkout"})]}),t.jsxs(r,{sx:{mb:4},children:[t.jsx(l,{variant:"determinate",value:75,sx:{height:6,borderRadius:3,bgcolor:"#e9ecef","& .MuiLinearProgress-bar":{borderRadius:3,bgcolor:"#e74c3c"}}}),t.jsx(i,{sx:{mt:1,fontSize:"0.9rem",color:"#666",textAlign:"center"},children:"Shipping and Checkout"})]}),X>0&&t.jsx(r,{sx:{bgcolor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:2,p:2,mb:4,textAlign:"center"},children:t.jsxs(i,{sx:{color:"#856404",fontWeight:600,fontSize:"0.95rem"},children:["Your order is reserved for: ",(re=X,`${Math.floor(re/60)}:${(re%60).toString().padStart(2,"0")}`)]})}),t.jsxs(c,{container:!0,spacing:4,sx:{display:"flex",flexWrap:"wrap"},children:[t.jsx(c,{item:!0,xs:12,sm:12,md:8,lg:8,sx:{display:"flex",flexDirection:"column"},children:t.jsxs(d,{sx:{p:4,borderRadius:2},children:[!$&&t.jsx(r,{sx:{mb:3,textAlign:"center"},children:t.jsxs(i,{sx:{color:"#666",fontSize:"0.9rem"},children:["Returning customer?",t.jsx(f,{variant:"text",sx:{ml:1,p:0,minWidth:"auto",textTransform:"none",color:"#e74c3c",fontWeight:600},children:"Click here to login"})]})}),t.jsx(i,{variant:"h5",sx:{fontWeight:600,color:"#333",mb:3,fontFamily:"Inter, sans-serif"},children:"Billing details"}),t.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:3},children:[t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["First name ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(x,{fullWidth:!0,name:"firstName",value:H.firstName,onChange:te,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Last name ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(x,{fullWidth:!0,name:"lastName",value:H.lastName,onChange:te,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Country / Region ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(h,{fullWidth:!0,size:"small",children:t.jsxs(m,{name:"country",value:H.country,onChange:te,sx:{borderRadius:1,bgcolor:"#ffffff"},children:[t.jsx(u,{value:"India",children:"India"}),t.jsx(u,{value:"United States",children:"United States (US)"}),t.jsx(u,{value:"United Kingdom",children:"United Kingdom (UK)"}),t.jsx(u,{value:"Canada",children:"Canada"}),t.jsx(u,{value:"Australia",children:"Australia"})]})})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Street address ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(x,{fullWidth:!0,name:"address1",value:H.address1,onChange:te,required:!0,variant:"outlined",size:"small",placeholder:"House number and street name",sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}}),t.jsx(x,{fullWidth:!0,name:"address2",value:H.address2,onChange:te,variant:"outlined",size:"small",placeholder:"Apartment, suite, unit, etc. (optional)",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Town / City ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(x,{fullWidth:!0,name:"city",value:H.city,onChange:te,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["State ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(x,{fullWidth:!0,name:"state",value:H.state,onChange:te,required:!0,variant:"outlined",size:"small",placeholder:"Enter your state",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["ZIP Code ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(x,{fullWidth:!0,name:"pincode",value:H.pincode,onChange:te,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Phone ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(x,{fullWidth:!0,name:"phone",value:H.phone,onChange:te,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(i,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Email address ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(x,{fullWidth:!0,name:"email",type:"email",value:H.email,onChange:te,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]})]})]})}),t.jsx(c,{item:!0,xs:12,sm:12,md:4,lg:4,sx:{display:"flex",flexDirection:"column"},children:t.jsxs(d,{sx:{p:4,borderRadius:2,position:"sticky",top:20,bgcolor:"#ffffff"},children:[t.jsx(i,{variant:"h5",sx:{fontWeight:600,color:"#333",mb:3,fontFamily:"Inter, sans-serif"},children:"Your order"}),t.jsx(r,{sx:{mb:3},children:E.map(e=>t.jsxs(r,{sx:{display:"flex",gap:2,mb:2,pb:2,borderBottom:"1px solid #eee"},children:[t.jsx(r,{sx:{width:50,height:50,borderRadius:1,overflow:"hidden",flexShrink:0,bgcolor:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:e.image?t.jsx("img",{src:e.image||`https://soukandstiches.mycartly.in/uploads/products/1532365/${e.product_id}_v1.png`,alt:e.name,style:{width:"100%",height:"100%",objectFit:"cover"},onError:s=>{s.target.src.includes("_v1.png")?s.target.style.display="none":s.target.src=`https://soukandstiches.mycartly.in/uploads/products/1532365/${e.product_id}_v1.png`}}):t.jsx(r,{sx:{width:"100%",height:"100%",bgcolor:"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"0.7rem"},children:"No Image"})}),t.jsxs(r,{sx:{flex:1},children:[t.jsx(i,{sx:{fontSize:"0.9rem",fontWeight:500,color:"#333",mb:.5},children:e.name}),t.jsxs(i,{sx:{fontSize:"0.8rem",color:"#666",mb:.5},children:["Qty: ",e.quantity]}),t.jsxs(i,{sx:{fontSize:"0.9rem",fontWeight:600,color:"#333"},children:["₹",(e.price*e.quantity).toLocaleString()]})]})]},e.id))}),t.jsx(p,{sx:{my:3}}),t.jsxs(r,{sx:{mb:3},children:[t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[t.jsx(i,{sx:{fontSize:"0.9rem",color:"#333"},children:"Subtotal"}),t.jsxs(i,{sx:{fontSize:"0.9rem",color:"#333"},children:["₹",G.subtotal.toLocaleString()]})]}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[t.jsx(i,{sx:{fontSize:"0.9rem",color:"#333"},children:"Shipping"}),t.jsx(i,{sx:{fontSize:"0.9rem",color:"#333"},children:0===G.shipping?"FREE":`₹${G.shipping}`})]}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[t.jsx(i,{sx:{fontSize:"0.9rem",color:"#333"},children:"Tax"}),t.jsxs(i,{sx:{fontSize:"0.9rem",color:"#333"},children:["₹",G.tax.toLocaleString()]})]}),t.jsx(p,{sx:{my:2}}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[t.jsx(i,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:"Total"}),t.jsxs(i,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:["₹",G.total.toLocaleString()]})]})]}),t.jsx(i,{variant:"h6",sx:{fontWeight:600,color:"#333",mb:2},children:"Payment"}),t.jsx(h,{component:"fieldset",fullWidth:!0,children:t.jsxs(g,{value:Y,onChange:e=>{const s=e.target.value;J(s);const t=D()||{};A({...t,paymentMethod:s})},children:[t.jsx(j,{value:"cod",control:t.jsx(y,{sx:{color:"#e74c3c"}}),label:t.jsxs(r,{children:[t.jsx(i,{sx:{fontWeight:500},children:"Cash on Delivery"}),t.jsx(i,{sx:{fontSize:"0.8rem",color:"#666"},children:"Pay when your order arrives"})]}),sx:{mb:2}}),t.jsx(j,{value:"online",control:t.jsx(y,{sx:{color:"#e74c3c"}}),label:t.jsxs(r,{children:[t.jsx(i,{sx:{fontWeight:500},children:"Online Payment"}),t.jsx(i,{sx:{fontSize:"0.8rem",color:"#666"},children:"Pay securely with UPI, Cards, or Wallets"})]})})]})}),t.jsx(r,{sx:{my:3},children:t.jsx(j,{control:t.jsx(b,{checked:Z,onChange:e=>{const s=e.target.checked;Q(s);const t=D()||{};A({...t,termsAccepted:s})},sx:{color:"#e74c3c"}}),label:t.jsxs(i,{sx:{fontSize:"0.9rem"},children:["I have read and agree to the website"," ",t.jsx(f,{variant:"text",sx:{p:0,minWidth:"auto",textTransform:"none",color:"#e74c3c",fontWeight:600,textDecoration:"underline"},children:"terms and conditions"})," ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]})})}),t.jsx(f,{fullWidth:!0,variant:"contained",size:"large",onClick:async()=>{if((()=>{const e=["firstName","lastName","address1","city","state","pincode","phone","email"];for(let s of e)if(!H[s].trim())return B({open:!0,message:`Please fill in ${s.replace(/([A-Z])/g," $1").toLowerCase()}`,severity:"error"}),!1;return!!Z||(B({open:!0,message:"Please accept the terms and conditions",severity:"error"}),!1)})()){L(!0);try{const s={customer_details:{firstName:H.firstName,lastName:H.lastName,email:H.email,phone:H.phone,address:`${H.address1}${H.address2?", "+H.address2:""}, ${H.city}, ${H.state} ${H.pincode}, ${H.country}`},payment_method:Y,items:E.map(e=>({product_id:e.product_id,quantity:e.quantity,price:e.price,selected_variants:e.selected_variants||{}}))};if("online"===Y)try{const e=await _.post("/order",{...s,payment_method:"razorpay"});if(!e.data.success)throw new Error(e.data.error||"Failed to create order");{const s=e.data.order_id,t={amount:G.total,customer_name:`${H.firstName} ${H.lastName}`,customer_email:H.email,customer_phone:H.phone,order_id:s,description:`Order #${s} - Souk and Stitch`},r=await(async e=>new Promise((s,t)=>{if(void 0===window.Razorpay)return void t(new Error("Razorpay SDK not loaded"));const r={key:w.key_id,amount:100*e.amount,currency:w.currency,name:w.name,description:e.description||w.description,handler:function(e){s({success:!0,payment_id:e.razorpay_payment_id,order_id:e.razorpay_order_id,signature:e.razorpay_signature})},prefill:{name:e.customer_name,email:e.customer_email,contact:e.customer_phone},notes:{order_id:e.order_id},theme:w.theme,modal:{ondismiss:function(){t(new Error("Payment cancelled by user"))}}};new window.Razorpay(r).open()}))(t);r.success&&(T(),k(`/order-success/${s}`))}}catch(e){if("Payment cancelled by user"!==e.message)throw e;B({open:!0,message:"Payment was cancelled",severity:"warning"})}else{const e=await _.post("/order",s);if(!e.data.success)throw new Error(e.data.error||"Failed to place order");T(),k(`/order-success/${e.data.order_id}`)}}catch(s){B({open:!0,message:s.message||"Failed to place order",severity:"error"})}finally{L(!1)}}},disabled:F||!Z,startIcon:F?t.jsx(v,{size:20}):t.jsx(S,{}),sx:{bgcolor:"#28a745",color:"#ffffff",py:1.5,fontSize:"1rem",fontWeight:600,borderRadius:2,"&:hover":{bgcolor:"#218838"},"&:disabled":{bgcolor:"#e9ecef",color:"#6c757d"}},children:F?"Placing Order...":"Place order"}),t.jsxs(r,{sx:{mt:3,display:"flex",flexWrap:"wrap",gap:1,justifyContent:"center"},children:[t.jsx(z,{label:"100% SECURE",size:"small",sx:{bgcolor:"#e8f5e8",color:"#28a745",fontWeight:600,fontSize:"0.7rem"}}),t.jsx(z,{label:"SSL ENCRYPTED",size:"small",sx:{bgcolor:"#e8f5e8",color:"#28a745",fontWeight:600,fontSize:"0.7rem"}}),t.jsx(z,{label:"TRUSTED",size:"small",sx:{bgcolor:"#e8f5e8",color:"#28a745",fontWeight:600,fontSize:"0.7rem"}})]}),t.jsxs(r,{sx:{mt:4,p:3,bgcolor:"#f8f9fa",borderRadius:2,textAlign:"center"},children:[t.jsx(i,{sx:{fontSize:"0.8rem",color:"#666",fontStyle:"italic",mb:1},children:'"The quality of the customer service and speed of delivery was just fantastic - I know I can count on Souk and Stitch every time!"'}),t.jsx(i,{sx:{fontSize:"0.75rem",color:"#999",fontWeight:500},children:"- Happy Customer"})]})]})})]})]}),t.jsx(W,{open:U.open,autoHideDuration:6e3,onClose:()=>B({...U,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(C,{onClose:()=>B({...U,open:!1}),severity:U.severity,sx:{width:"100%",borderRadius:2},children:U.message})})]});var re};export{k as default};
