import{a as e,r as s,j as t,B as r,aH as o,I as i,aw as n,T as a,aI as l,V as c,P as d,i as x,g as f,aD as h,aF as m,N as u,v as p,aJ as g,aK as j,aL as b,aM as y,C as v,aN as S,t as z,ab as W,A as C}from"./mui-C7nK-0ZR.js";import{u as I,a as R}from"./index-DFhyYAZK.js";import{u as w}from"./router-DoZmC-hp.js";import"./vendor-HnKmhvXM.js";import"./utils-fGN9A5xN.js";const N="checkout_form_data",E=()=>{const E=w();e("(max-width:768px)");const{cartItems:M,getCartTotal:k,isLoggedIn:O,customerData:P,updateCartItem:$,removeFromCart:_}=I(),q=e=>{try{localStorage.setItem(N,JSON.stringify(e))}catch(s){}},A=()=>{try{const e=localStorage.getItem(N);return e?JSON.parse(e):null}catch(e){return null}},T=()=>{try{localStorage.removeItem(N)}catch(e){}},[D,F]=s.useState(!1),[L,U]=s.useState({open:!1,message:"",severity:"success"}),[H,K]=s.useState({firstName:"",lastName:"",country:"India",address1:"",address2:"",city:"",state:"",pincode:"",phone:"",email:""}),[B,J]=s.useState("cod"),[Y,Z]=s.useState(!1),[Q,V]=s.useState({subtotal:0,shipping:0,tax:0,total:0}),[G,X]=s.useState(600);s.useEffect(()=>{ee()},[M]),s.useEffect(()=>{const e=A();e&&(K(s=>({...s,...e})),e.paymentMethod&&J(e.paymentMethod),void 0!==e.termsAccepted&&Z(e.termsAccepted))},[]),s.useEffect(()=>{P&&O&&K(e=>({...e,firstName:P.firstName||e.firstName,lastName:P.lastName||e.lastName,email:P.email||e.email,phone:P.phone||e.phone}))},[P,O]),s.useEffect(()=>{O||T()},[O]),s.useEffect(()=>{const e=setInterval(()=>{X(s=>s<=1?(clearInterval(e),0):s-1)},1e3);return()=>clearInterval(e)},[]);const ee=()=>{const e=k(),s=e>999?0:99;V({subtotal:e,shipping:s,tax:0,total:e+s+0})},se=e=>{const{name:s,value:t,type:r,checked:o}=e.target,i={...H,[s]:"checkbox"===r?o:t};K(i),q(i)};return t.jsxs(r,{sx:{minHeight:"100vh",bgcolor:"#f8f9fa",py:4},children:[t.jsxs(o,{maxWidth:"xl",children:[t.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[t.jsx(i,{onClick:()=>E("/"),sx:{bgcolor:"#ffffff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)","&:hover":{bgcolor:"#f5f5f5"}},children:t.jsx(n,{})}),t.jsx(a,{variant:"h4",sx:{fontWeight:600,color:"#333",fontFamily:"Inter, sans-serif"},children:"Checkout"})]}),t.jsxs(r,{sx:{mb:4},children:[t.jsx(l,{variant:"determinate",value:75,sx:{height:6,borderRadius:3,bgcolor:"#e9ecef","& .MuiLinearProgress-bar":{borderRadius:3,bgcolor:"#e74c3c"}}}),t.jsx(a,{sx:{mt:1,fontSize:"0.9rem",color:"#666",textAlign:"center"},children:"Shipping and Checkout"})]}),G>0&&t.jsx(r,{sx:{bgcolor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:2,p:2,mb:4,textAlign:"center"},children:t.jsxs(a,{sx:{color:"#856404",fontWeight:600,fontSize:"0.95rem"},children:["Your order is reserved for: ",(te=G,`${Math.floor(te/60)}:${(te%60).toString().padStart(2,"0")}`)]})}),t.jsxs(c,{container:!0,spacing:4,sx:{display:"flex",flexWrap:"wrap"},children:[t.jsx(c,{item:!0,xs:12,sm:12,md:8,lg:8,sx:{display:"flex",flexDirection:"column"},children:t.jsxs(d,{sx:{p:4,borderRadius:2},children:[!O&&t.jsx(r,{sx:{mb:3,textAlign:"center"},children:t.jsxs(a,{sx:{color:"#666",fontSize:"0.9rem"},children:["Returning customer?",t.jsx(x,{variant:"text",sx:{ml:1,p:0,minWidth:"auto",textTransform:"none",color:"#e74c3c",fontWeight:600},children:"Click here to login"})]})}),t.jsx(a,{variant:"h5",sx:{fontWeight:600,color:"#333",mb:3,fontFamily:"Inter, sans-serif"},children:"Billing details"}),t.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:3},children:[t.jsxs(r,{children:[t.jsxs(a,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["First name ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(f,{fullWidth:!0,name:"firstName",value:H.firstName,onChange:se,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(a,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Last name ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(f,{fullWidth:!0,name:"lastName",value:H.lastName,onChange:se,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(a,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Country / Region ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(h,{fullWidth:!0,size:"small",children:t.jsxs(m,{name:"country",value:H.country,onChange:se,sx:{borderRadius:1,bgcolor:"#ffffff"},children:[t.jsx(u,{value:"India",children:"India"}),t.jsx(u,{value:"United States",children:"United States (US)"}),t.jsx(u,{value:"United Kingdom",children:"United Kingdom (UK)"}),t.jsx(u,{value:"Canada",children:"Canada"}),t.jsx(u,{value:"Australia",children:"Australia"})]})})]}),t.jsxs(r,{children:[t.jsxs(a,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Street address ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(f,{fullWidth:!0,name:"address1",value:H.address1,onChange:se,required:!0,variant:"outlined",size:"small",placeholder:"House number and street name",sx:{mb:2,"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}}),t.jsx(f,{fullWidth:!0,name:"address2",value:H.address2,onChange:se,variant:"outlined",size:"small",placeholder:"Apartment, suite, unit, etc. (optional)",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(a,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Town / City ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(f,{fullWidth:!0,name:"city",value:H.city,onChange:se,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(a,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["State ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(f,{fullWidth:!0,name:"state",value:H.state,onChange:se,required:!0,variant:"outlined",size:"small",placeholder:"Enter your state",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(a,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["ZIP Code ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(f,{fullWidth:!0,name:"pincode",value:H.pincode,onChange:se,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(a,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Phone ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(f,{fullWidth:!0,name:"phone",value:H.phone,onChange:se,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]}),t.jsxs(r,{children:[t.jsxs(a,{sx:{mb:1,fontWeight:500,color:"#333",fontSize:"0.9rem"},children:["Email address ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]}),t.jsx(f,{fullWidth:!0,name:"email",type:"email",value:H.email,onChange:se,required:!0,variant:"outlined",size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,bgcolor:"#ffffff"}}})]})]})]})}),t.jsx(c,{item:!0,xs:12,sm:12,md:4,lg:4,sx:{display:"flex",flexDirection:"column"},children:t.jsxs(d,{sx:{p:4,borderRadius:2,position:"sticky",top:20,bgcolor:"#ffffff"},children:[t.jsx(a,{variant:"h5",sx:{fontWeight:600,color:"#333",mb:3,fontFamily:"Inter, sans-serif"},children:"Your order"}),t.jsx(r,{sx:{mb:3},children:M.map(e=>t.jsxs(r,{sx:{display:"flex",gap:2,mb:2,pb:2,borderBottom:"1px solid #eee"},children:[t.jsx(r,{sx:{width:50,height:50,borderRadius:1,overflow:"hidden",flexShrink:0,bgcolor:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:e.image?t.jsx("img",{src:e.image||`https://ssas.mycartly.in/uploads/products/1532365/${e.product_id}_v1.png`,alt:e.name,style:{width:"100%",height:"100%",objectFit:"cover"},onError:s=>{s.target.src.includes("_v1.png")?s.target.style.display="none":s.target.src=`https://ssas.mycartly.in/uploads/products/1532365/${e.product_id}_v1.png`}}):t.jsx(r,{sx:{width:"100%",height:"100%",bgcolor:"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"0.7rem"},children:"No Image"})}),t.jsxs(r,{sx:{flex:1},children:[t.jsx(a,{sx:{fontSize:"0.9rem",fontWeight:500,color:"#333",mb:.5},children:e.name}),t.jsxs(a,{sx:{fontSize:"0.8rem",color:"#666",mb:.5},children:["Qty: ",e.quantity]}),t.jsxs(a,{sx:{fontSize:"0.9rem",fontWeight:600,color:"#333"},children:["₹",(e.price*e.quantity).toLocaleString()]})]})]},e.id))}),t.jsx(p,{sx:{my:3}}),t.jsxs(r,{sx:{mb:3},children:[t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[t.jsx(a,{sx:{fontSize:"0.9rem",color:"#333"},children:"Subtotal"}),t.jsxs(a,{sx:{fontSize:"0.9rem",color:"#333"},children:["₹",Q.subtotal.toLocaleString()]})]}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[t.jsx(a,{sx:{fontSize:"0.9rem",color:"#333"},children:"Shipping"}),t.jsx(a,{sx:{fontSize:"0.9rem",color:"#333"},children:0===Q.shipping?"FREE":`₹${Q.shipping}`})]}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[t.jsx(a,{sx:{fontSize:"0.9rem",color:"#333"},children:"Tax"}),t.jsxs(a,{sx:{fontSize:"0.9rem",color:"#333"},children:["₹",Q.tax.toLocaleString()]})]}),t.jsx(p,{sx:{my:2}}),t.jsxs(r,{sx:{display:"flex",justifyContent:"space-between"},children:[t.jsx(a,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:"Total"}),t.jsxs(a,{variant:"h6",sx:{fontWeight:600,color:"#333"},children:["₹",Q.total.toLocaleString()]})]})]}),t.jsx(a,{variant:"h6",sx:{fontWeight:600,color:"#333",mb:2},children:"Payment"}),t.jsx(h,{component:"fieldset",fullWidth:!0,children:t.jsxs(g,{value:B,onChange:e=>{const s=e.target.value;J(s);const t=A()||{};q({...t,paymentMethod:s})},children:[t.jsx(j,{value:"cod",control:t.jsx(b,{sx:{color:"#e74c3c"}}),label:t.jsxs(r,{children:[t.jsx(a,{sx:{fontWeight:500},children:"Cash on Delivery"}),t.jsx(a,{sx:{fontSize:"0.8rem",color:"#666"},children:"Pay when your order arrives"})]}),sx:{mb:2}}),t.jsx(j,{value:"online",control:t.jsx(b,{sx:{color:"#e74c3c"}}),label:t.jsxs(r,{children:[t.jsx(a,{sx:{fontWeight:500},children:"Online Payment"}),t.jsx(a,{sx:{fontSize:"0.8rem",color:"#666"},children:"Pay securely with UPI, Cards, or Wallets"})]})})]})}),t.jsx(r,{sx:{my:3},children:t.jsx(j,{control:t.jsx(y,{checked:Y,onChange:e=>{const s=e.target.checked;Z(s);const t=A()||{};q({...t,termsAccepted:s})},sx:{color:"#e74c3c"}}),label:t.jsxs(a,{sx:{fontSize:"0.9rem"},children:["I have read and agree to the website"," ",t.jsx(x,{variant:"text",sx:{p:0,minWidth:"auto",textTransform:"none",color:"#e74c3c",fontWeight:600,textDecoration:"underline"},children:"terms and conditions"})," ",t.jsx("span",{style:{color:"#e74c3c"},children:"*"})]})})}),t.jsx(x,{fullWidth:!0,variant:"contained",size:"large",onClick:async()=>{if((()=>{const e=["firstName","lastName","address1","city","state","pincode","phone","email"];for(let s of e)if(!H[s].trim())return U({open:!0,message:`Please fill in ${s.replace(/([A-Z])/g," $1").toLowerCase()}`,severity:"error"}),!1;return!!Y||(U({open:!0,message:"Please accept the terms and conditions",severity:"error"}),!1)})()){F(!0);try{const e={customer_details:{firstName:H.firstName,lastName:H.lastName,email:H.email,phone:H.phone,address:`${H.address1}${H.address2?", "+H.address2:""}, ${H.city}, ${H.state} ${H.pincode}, ${H.country}`},payment_method:B,items:M.map(e=>({product_id:e.product_id,quantity:e.quantity,price:e.price,selected_variants:e.selected_variants||{}}))},s=await R.post("/order",e);if(!s.data.success)throw new Error(s.data.error||"Failed to place order");T(),E(`/order-success/${s.data.order_id}`)}catch(e){U({open:!0,message:e.message||"Failed to place order",severity:"error"})}finally{F(!1)}}},disabled:D||!Y,startIcon:D?t.jsx(v,{size:20}):t.jsx(S,{}),sx:{bgcolor:"#28a745",color:"#ffffff",py:1.5,fontSize:"1rem",fontWeight:600,borderRadius:2,"&:hover":{bgcolor:"#218838"},"&:disabled":{bgcolor:"#e9ecef",color:"#6c757d"}},children:D?"Placing Order...":"Place order"}),t.jsxs(r,{sx:{mt:3,display:"flex",flexWrap:"wrap",gap:1,justifyContent:"center"},children:[t.jsx(z,{label:"100% SECURE",size:"small",sx:{bgcolor:"#e8f5e8",color:"#28a745",fontWeight:600,fontSize:"0.7rem"}}),t.jsx(z,{label:"SSL ENCRYPTED",size:"small",sx:{bgcolor:"#e8f5e8",color:"#28a745",fontWeight:600,fontSize:"0.7rem"}}),t.jsx(z,{label:"TRUSTED",size:"small",sx:{bgcolor:"#e8f5e8",color:"#28a745",fontWeight:600,fontSize:"0.7rem"}})]}),t.jsxs(r,{sx:{mt:4,p:3,bgcolor:"#f8f9fa",borderRadius:2,textAlign:"center"},children:[t.jsx(a,{sx:{fontSize:"0.8rem",color:"#666",fontStyle:"italic",mb:1},children:'"The quality of the customer service and speed of delivery was just fantastic - I know I can count on Souka and Stitches every time!"'}),t.jsx(a,{sx:{fontSize:"0.75rem",color:"#999",fontWeight:500},children:"- Happy Customer"})]})]})})]})]}),t.jsx(W,{open:L.open,autoHideDuration:6e3,onClose:()=>U({...L,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(C,{onClose:()=>U({...L,open:!1}),severity:L.severity,sx:{width:"100%",borderRadius:2},children:L.message})})]});var te};export{E as default};
