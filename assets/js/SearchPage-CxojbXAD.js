import{a as e,r,j as t,B as s,g as n,ax as o,I as a,az as i,T as l,aB as c,a9 as d,A as x,aF as p,aC as u,aD as h,aE as g,V as f}from"./mui-C2LQx1Gq.js";import{u as m,a as b,b as j}from"./index-DpF8hge0.js";import{C as y,P as C}from"./CarouselItem-DwpXOYGb.js";import{d as v,u as S}from"./router-CTjFK5iR.js";import"./vendor-HnKmhvXM.js";import"./utils-BpzWs0EA.js";const k=()=>{const[k]=v(),w=S(),I=e("(max-width:768px)"),W=e("(max-width:1024px)"),{addToCart:z,isLoggedIn:B,login:R}=m(),[M,F]=r.useState([]),[A,E]=r.useState([]),[L,P]=r.useState(!0),[D,H]=r.useState(!1),[O,T]=r.useState({open:!1,message:"",severity:"success"}),[$,_]=r.useState(null),[N,q]=r.useState(!1),[V,U]=r.useState(""),[Z,G]=r.useState([0,1e5]),[J,K]=r.useState("newest");r.useEffect(()=>{const e=k.get("q");e?(F([]),E([]),U(e),Q(e)):(F([]),E([]),U(""),P(!1))},[k]),r.useEffect(()=>{X()},[M,Z,J]);const Q=async e=>{try{P(!0);const r=await b.get(`/search?q=${encodeURIComponent(e)}`);if(r.data?.success){const e=r.data.products||[],t=await Promise.all(e.map(async e=>{try{const r=await b.get(`/product/${e.product_id}`);if(r.data?.success&&r.data?.product){const t=(r.data.product.images||[]).map(e=>{if(e&&e.includes("/uploads/")){return`https://soukandstiches.mycartly.in${e.substring(e.indexOf("/uploads/"))}`}return e});return{...e,images:t}}}catch(r){}return e}));F(t)}else F([])}catch(r){F([])}finally{P(!1)}},X=()=>{let e=[...M];e=e.filter(e=>{const r=parseFloat(e.price)||0;return r>=Z[0]&&r<=Z[1]}),e.sort((e,r)=>{switch(J){case"price-low":return(parseFloat(e.price)||0)-(parseFloat(r.price)||0);case"price-high":return(parseFloat(r.price)||0)-(parseFloat(e.price)||0);case"name":return e.name.localeCompare(r.name);default:return new Date(r.created_at||0)-new Date(e.created_at||0)}}),E(e)},Y=(e,r)=>{G(r)},ee=e=>{K(e.target.value)},re=()=>t.jsxs(s,{sx:{p:2,height:"fit-content",bgcolor:"#fafafa",borderRight:"1px solid #e0e0e0"},children:[t.jsxs(l,{variant:"body2",sx:{color:"#666",mb:2,fontSize:"12px"},children:['Home > Search > "',V,'"']}),t.jsx(s,{sx:{mb:3},children:t.jsx("button",{onClick:()=>w("/"),style:{width:"100%",textAlign:"left",color:"#333",fontSize:"14px",fontWeight:500,padding:"8px 12px",border:"none",background:"transparent",cursor:"pointer",borderRadius:"4px",transition:"background-color 0.2s ease"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(0,0,0,0.04)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"Home"})}),t.jsxs(s,{sx:{mb:3},children:[t.jsx(l,{variant:"h6",sx:{mb:1.5,fontWeight:600,color:"#8B4513",fontSize:"16px"},children:"Price Range"}),t.jsxs(s,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[t.jsx("button",{onClick:()=>G([0,7500]),style:{width:"100%",textAlign:"left",color:"#333",fontSize:"14px",fontWeight:400,padding:"8px 12px",border:"none",background:"transparent",cursor:"pointer",borderRadius:"4px",transition:"background-color 0.2s ease"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(0,0,0,0.04)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"Rs. 0 - 7,500"}),t.jsx("button",{onClick:()=>G([7501,15e3]),style:{width:"100%",textAlign:"left",color:"#333",fontSize:"14px",fontWeight:400,padding:"8px 12px",border:"none",background:"transparent",cursor:"pointer",borderRadius:"4px",transition:"background-color 0.2s ease"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(0,0,0,0.04)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"Rs. 7,501 - 15,000"}),t.jsx("button",{onClick:()=>G([15e3,1e5]),style:{width:"100%",textAlign:"left",color:"#333",fontSize:"14px",fontWeight:400,padding:"8px 12px",border:"none",background:"transparent",cursor:"pointer",borderRadius:"4px",transition:"background-color 0.2s ease"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(0,0,0,0.04)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",children:"Rs. 15,000+"})]})]}),t.jsxs(s,{children:[t.jsx(l,{variant:"h6",sx:{mb:1.5,fontWeight:600,color:"#8B4513",fontSize:"16px"},children:"Filters"}),t.jsxs(s,{sx:{mb:2},children:[t.jsxs(l,{variant:"body2",sx:{mb:1,color:"#666"},children:["Price Range: ₹",Z[0].toLocaleString()," - ₹",Z[1].toLocaleString()]}),t.jsx(p,{value:Z,onChange:Y,valueLabelDisplay:"auto",min:0,max:1e5,step:1e3,sx:{color:"#8B4513","& .MuiSlider-thumb":{"&:hover, &.Mui-focusVisible":{boxShadow:"0px 0px 0px 8px rgba(139, 69, 19, 0.16)"}}}})]}),t.jsx(s,{children:t.jsxs(u,{fullWidth:!0,size:"small",children:[t.jsx(h,{sx:{color:"#666"},children:"Sort By"}),t.jsxs(g,{value:J,onChange:ee,label:"Sort By",sx:{borderRadius:1,"& .MuiOutlinedInput-notchedOutline":{borderColor:"#e0e0e0"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#8B4513"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#8B4513"}},children:[t.jsx(f,{value:"newest",children:"Newest First"}),t.jsx(f,{value:"price-low",children:"Price: Low to High"}),t.jsx(f,{value:"price-high",children:"Price: High to Low"}),t.jsx(f,{value:"name",children:"Name: A to Z"})]})]})})]})]});return t.jsxs(s,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",py:{xs:2,md:4}},children:[t.jsxs(s,{sx:{maxWidth:1400,mx:"auto"},children:[t.jsxs(s,{sx:{mb:6,p:0,position:"relative",overflow:"hidden",minHeight:"300px","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:"url('https://picsum.photos/1200/400?random=search')",backgroundSize:"cover",backgroundPosition:"center",opacity:.1,zIndex:0},"& > *":{position:"relative",zIndex:1}},children:[t.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3,px:4,pt:4},children:[t.jsx(n,{startIcon:t.jsx(o,{}),onClick:()=>w("/"),sx:{color:"#333",textTransform:"none",fontWeight:500,"&:hover":{backgroundColor:"rgba(0,0,0,0.04)"}},children:"Back to Home"}),!I&&t.jsx(s,{sx:{display:"flex",gap:2},children:t.jsx(a,{sx:{color:"#333"},children:t.jsx(i,{})})})]}),t.jsx(l,{variant:"h4",sx:{fontWeight:700,color:"#2c3e50",fontFamily:'"Inter", sans-serif',fontSize:{xs:"1.5rem",sm:"2rem",md:"2.5rem"},mb:2,textAlign:"center",px:4},children:"Search Results"}),t.jsxs(s,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:2,flexWrap:"wrap",px:4,pb:4},children:[t.jsx(l,{variant:"h6",sx:{color:"#6c757d",fontFamily:'"Inter", sans-serif',fontWeight:500},children:L?"Searching...":`${A.length} product${1!==A.length?"s":""} found for "${V}"`}),t.jsxs(s,{sx:{display:"flex",gap:3,alignItems:"center"},children:[t.jsx(s,{sx:{background:"linear-gradient(135deg, #E91E63 0%, #C2185B 100%)",color:"white",px:2,py:1,borderRadius:2,fontSize:"0.8rem",fontWeight:600},children:"Best Prices"}),t.jsx(s,{sx:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",color:"white",px:2,py:1,borderRadius:2,fontSize:"0.8rem",fontWeight:600},children:"Free Shipping"})]})]})]}),t.jsxs(s,{sx:{display:"flex",gap:3,flexDirection:{xs:"column",lg:"row"}},children:[!W&&t.jsx(s,{sx:{width:{lg:280},flexShrink:0},children:t.jsx(s,{sx:{overflow:"hidden"},children:re()})}),t.jsx(s,{sx:{flex:1,minWidth:0},children:L?t.jsx(s,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(3, 1fr)",sm:"repeat(3, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(3, 1fr)"},gap:3,justifyContent:"center",alignItems:"start"},children:Array.from({length:8}).map((e,r)=>t.jsx(s,{sx:{width:"100%",maxWidth:"100%",justifySelf:"center"},children:t.jsx(C,{})},r))}):A.length>0?t.jsx(t.Fragment,{children:t.jsx(s,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(3, 1fr)",sm:"repeat(3, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(3, 1fr)"},gap:3,justifyContent:"center",alignItems:"start"},children:A.map(e=>t.jsx(s,{sx:{width:"100%",maxWidth:"100%",justifySelf:"start"},children:t.jsx(y,{product:e})},e.product_id))})}):t.jsxs(s,{sx:{textAlign:"center",py:8,px:4},children:[t.jsx(l,{variant:"h5",sx:{color:"#666",mb:2,fontWeight:500},children:"No products found"}),t.jsx(l,{variant:"body1",sx:{color:"#999",mb:4},children:"Try adjusting your search terms or filters"}),t.jsx(n,{variant:"contained",onClick:()=>w("/"),sx:{background:"linear-gradient(135deg, #E91E63 0%, #C2185B 100%)","&:hover":{background:"linear-gradient(135deg, #C2185B 0%, #AD1457 100%)"}},children:"Browse All Products"})]})})]})]}),t.jsx(c,{anchor:"right",open:N,onClose:()=>q(!1),PaperProps:{sx:{width:W?320:380}},children:re()}),t.jsx(j,{open:D,onClose:()=>H(!1),onLoginSuccess:function(e){H(!1),R(e)}}),t.jsx(d,{open:O.open,autoHideDuration:3e3,onClose:()=>T({...O,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:t.jsx(x,{onClose:()=>T({...O,open:!1}),severity:O.severity,sx:{width:"100%"},children:O.message})})]})};export{k as default};
